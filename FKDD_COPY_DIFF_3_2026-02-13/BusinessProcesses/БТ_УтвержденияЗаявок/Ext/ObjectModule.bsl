
Процедура НужныДопДанныеПроверкаУсловия(ТочкаМаршрутаБизнесПроцесса, Результат)
	Результат		= НужныДопДанные;
	НужныДопДанные	= Ложь;
	Записать();
КонецПроцедуры

Процедура ДопОпцияЗадействованаПроверкаУсловия(ТочкаМаршрутаБизнесПроцесса, Результат)
	Результат=ДопОпция;
	ДопОпция=Ложь;	
	Записать();
КонецПроцедуры

Процедура ЗаявкаУтвержденаПроверкаУсловия(ТочкаМаршрутаБизнесПроцесса, Результат)
	Результат=Утверждена;	
КонецПроцедуры

Процедура ПравитьЗаявкуПроверкаУсловия(ТочкаМаршрутаБизнесПроцесса, Результат)
	Результат=НужноИзменениеЗаявки;
	НужноИзменениеЗаявки=Ложь;
КонецПроцедуры

Процедура УстановкаСтатусаОбработка(ТочкаМаршрутаБизнесПроцесса)
КонецПроцедуры                    

Процедура УтверждениеЗаявкиПриСозданииЗадач(ТочкаМаршрутаБизнесПроцесса, ФормируемыеЗадачи, Отказ)
	
	Для Каждого Задача Из ФормируемыеЗадачи Цикл
		Задача.ВидЗаявки 	= ВидЗаявки;
		Задача.Роль			= ВедущаяЗадача.Роль;
		Если ВедущаяЗадача <> Неопределено Тогда
			Если ВедущаяЗадача.БизнесПроцесс <> Неопределено Тогда
				Задача.Заявка = ВедущаяЗадача.БизнесПроцесс;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
КонецПроцедуры

Процедура ОповещениеИсполнителяОбИзмененииЗаявкиОбработка(ТочкаМаршрутаБизнесПроцесса)
	//ПроцедурыЗаявокПользователя.ОповеститьИсполнителя(ВедущаяЗадача.БизнесПроцесс, Исполнитель,"Заявка была изменена.");
КонецПроцедуры

Процедура ПолучениеДополнительныхДанныхПриСозданииВложенныхБизнесПроцессов(ТочкаМаршрутаБизнесПроцесса, ФормируемыеБизнесПроцессы, Отказ)
	УстанавливаемыйВидЗаявки = Перечисления.БТ_ВидыЗаявок.ПолучитьВидЗаявки(ВедущаяЗадача.БизнесПроцесс);
	Для Каждого БП Из ФормируемыеБизнесПроцессы Цикл
		БП.Исполнитель			= Исполнитель;
		БП.Утверждающий			= ПараметрыСеанса.Пользователь;
		БП.ВидЗаявки			= УстанавливаемыйВидЗаявки;
		БП.ЗаявкаПользователя	= ВедущаяЗадача.БизнесПроцесс;
	КонецЦикла;
КонецПроцедуры

Процедура УстановкаДопОпцииОбработка(ТочкаМаршрутаБизнесПроцесса)
	//ВедущийБП=ВедущаяЗадача.БизнесПроцесс.ПолучитьОбъект();
	//ВедущийБП.ДопОпция=Истина;
	//ВедущийБП.Записать();
КонецПроцедуры

Процедура ОтменаРодительскогоБизнесПроцессаОбработка(ТочкаМаршрутаБизнесПроцесса)
	//Отменен=ПроцедурыЗаявокПользователя.ОтменитьВсеДвиженияПоБизнесПроцессу(ВедущаяЗадача.БизнесПроцесс, Ссылка);
	Записать();
КонецПроцедуры

Процедура ОповещенияИсполнителяОбОтменеЗаявкиОбработка(ТочкаМаршрутаБизнесПроцесса)
	//Если ТипЗнч(ВедущаяЗадача.БизнесПроцесс) <> Тип("БизнесПроцессСсылка.ЗаявкаНаКредитнуюИсторию") Тогда
	//	Если ТипЗнч(ВедущаяЗадача.БизнесПроцесс) = Тип("БизнесПроцессСсылка.ЗаявкаНаОплату") Тогда
	//		
	//		//Струговщиков Начало 000105192 
	//		Попытка
	//			текстЗаявка = "(" +СокрЛП(ВедущаяЗадача.БизнесПроцесс) + ")";
	//		Исключение
	//			текстЗаявка = "";
	//		КонецПопытки;
	//		//Струговщиков Окончание 000105192
	//		
	//		ПроцедурыЗаявокПользователя.ОповеститьИсполнителя(	ВедущаяЗадача.БизнесПроцесс,
	//															Исполнитель,
	//															"Заявка была отменена. " + текстЗаявка + "<br />Причина: " + ВедущаяЗадача.БизнесПроцесс.ПричинаОтменыЗаявки+Символы.ПС+"<br />Отклонил: "+ВедущаяЗадача.БизнесПроцесс.Отклонил,
	//															Истина);
	//	ИначеЕсли 	//«24/10/16 Евтушенко Владимир 000085118
	//	ВыбратьЗначениеИзТаблицыТрансляции("ИспользоватьФункционал1С_ЛишниеОповещенияМТО")<>Неопределено И
	//	ВыбратьЗначениеИзТаблицыТрансляции("ИспользоватьФункционал1С_ЛишниеОповещенияМТО") И
	//			  	//24/10/16 Евтушенко Владимир 000085118»
	//	ТипЗнч(ВедущаяЗадача.БизнесПроцесс) = Тип("БизнесПроцессСсылка.СогласованиеСтрокТЧ") Тогда
	//		Запрос = Новый Запрос("ВЫБРАТЬ
	//		                      |	ЗаявкаНаМТООборудование.Комментарий
	//		                      |ИЗ
	//		                      |	БизнесПроцесс.ЗаявкаНаМТО.Оборудование КАК ЗаявкаНаМТООборудование
	//		                      |ГДЕ
	//		                      |	ЗаявкаНаМТООборудование.УникальныйИдентификаторСтроки = &УникальныйИдентификаторСтроки
	//		                      |	И ЗаявкаНаМТООборудование.Ссылка = &Ссылка");
	//		Запрос.УстановитьПараметр("Ссылка"							, ВедущаяЗадача.БизнесПроцесс.Основание);
	//		Запрос.УстановитьПараметр("УникальныйИдентификаторСтроки"	, ВедущаяЗадача.БизнесПроцесс.УникальныйИдентификаторСтроки);
	//		КомментПоПозиции = "";
	//		Выборка = Запрос.Выполнить().Выбрать();
	//		Если Выборка.Следующий() Тогда
	//			КомментПоПозиции = Выборка.Комментарий;
	//		КонецЕсли;
	//		ПроцедурыЗаявокПользователя.ОповеститьИсполнителя(	ВедущаяЗадача.БизнесПроцесс,
	//															Исполнитель,
	//															"Заявка была отправлена на доработку.<br />Причина: " + КомментПоПозиции + Символы.ПС + "<br />Отклонил: " + ВедущаяЗадача.БизнесПроцесс.Отклонил,
	//															Истина);
	//	Иначе

	//		//Струговщиков Начало 000105192 
	//		Попытка
	//			текстЗаявка = "(" +СокрЛП(ВедущаяЗадача.БизнесПроцесс) + ")";
	//		Исключение
	//			текстЗаявка = "";
	//		КонецПопытки;
	//		//Струговщиков Окончание 000105192
	//		
	//		ПроцедурыЗаявокПользователя.ОповеститьИсполнителя(	ВедущаяЗадача.БизнесПроцесс,
	//															Исполнитель,
	//															"Заявка была отменена. " + текстЗаявка + "<br />Причина: "+ВедущаяЗадача.БизнесПроцесс.ПричинаОтменыЗаявки+Символы.ПС+"<br />Отклонил: "+ВедущаяЗадача.БизнесПроцесс.Отклонил);
	//	КонецЕсли;
	//КонецЕсли;
КонецПроцедуры

Процедура ЗавершениеПриЗавершении(ТочкаМаршрутаБизнесПроцесса, Отказ)
	Если Найти(ВедущаяЗадача, "Объект не найден") > 0 Тогда
	Иначе
		ВедущаяЗадачаОбъект=ВедущаяЗадача.ПолучитьОбъект();
		ВедущаяЗадачаОбъект.ДатаВыПолнения = ТекущаяДата();
		Если Отменен Тогда
			ВедущаяЗадачаОбъект.Отменена = Истина;
		КонецЕсли;
		ВедущаяЗадачаОбъект.Записать();
	КонецЕсли;
КонецПроцедуры

Процедура УсловиеПользовательОтказалсяОтОтменыПроверкаУсловия(ТочкаМаршрутаБизнесПроцесса, Результат)
	Результат=Не Отменен;
КонецПроцедуры

Процедура ЗавершенАвтоматическиПроверкаУсловия(ТочкаМаршрутаБизнесПроцесса, Результат)
	Результат = ЗавершенАвтоматически;
КонецПроцедуры

Процедура ПолучениеДополнительныхДанныхПриСозданииЗадач(ТочкаМаршрутаБизнесПроцесса, ФормируемыеЗадачи, Отказ)
	УстанавливаемыйВидЗаявки = Перечисления.БТ_ВидыЗаявок.ПолучитьВидЗаявки(ВедущаяЗадача.БизнесПроцесс);
	Для каждого ФормЗадача Из ФормируемыеЗадачи Цикл
		ФормЗадача.Роль			= РольУтверждающего;
		ФормЗадача.ВидЗаявки	= УстанавливаемыйВидЗаявки;
		ФормЗадача.Заявка		= ВедущаяЗадача.БизнесПроцесс;
	КонецЦикла;
КонецПроцедуры


