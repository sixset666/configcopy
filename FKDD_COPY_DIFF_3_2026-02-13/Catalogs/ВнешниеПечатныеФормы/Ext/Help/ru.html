<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"></meta><link rel="stylesheet" type="text/css" href="v8help://service_book/service_style"></link><meta name="GENERATOR" content="MSHTML 9.00.8112.16440"></meta></head><body>
<h1><font color="#000080">Справочник "Внешние печатные формы"</font></h1>
<h3>Назначение</h3>
<p class="Usual">Справочник предназначен для хранения печатных форм документов конфигурации во внешних файлах или в базе данных. Загруженные печатные формы документов будут доступны в выпадающем меню кнопки "Печать" формы документа.</p>
<p class="Usual">Второе назначение справочника - это хранение внешних пользовательских отчетов и обработок в базе данных. Запуск соответствующих отчетов и обработок осуществляется из панели обработки <a href="DataProcessor.ВнешниеОбработкиИОтчеты/Help">«Внешние обработки и отчеты»</a>. Для этого отчеты и обработки должны быть помещены в соответствующие предопределенные группы справочника.</p>
<p class="Usual">Относится к подсистеме: <a href="Subsystem.СтруктураКонфигурации.Subsystem.Обработки.Subsystem.Сервис/Help">«Сервис»</a>.</p>
<p></p>
<h3>Параметры</h3>
<p class="Usual">Длина кода: 8, тип кода: Строка.</p>
<p class="Usual">Длина наименования: 100.</p>
<p class="Usual">Иерархический.</p>
<h3>Предопределенные элементы</h3>
<ul><li><strong>Внешние обработки</strong>. Наименование можно изменить. 
</li><li><strong>Внешние отчеты</strong>. Наименование можно изменить. 
</li><li><strong>Внешние печатные формы</strong>. Наименование можно изменить. 
</li><li><strong>Внешние обработки заполнения табличных частей</strong>. Наименование можно изменить.</li></ul><p></p>
<h3>Реквизиты   </h3>
<ul><li><strong>Хранить обработку в базе данных</strong>. Тип значения: «Булево». Печатная форма хранится в базе данных. 
</li><li><strong>Хранить обработку в файле</strong>. Тип значения: «Булево». Печатная форма хранится в виде внешней обработки. 
</li><li><strong>Путь к внешнему файлу</strong>. Тип значения: «Строка». Путь к внешнему файлу для варианта внешней печатной формы, хранящейся в виде внешней обработки. 
</li><li><strong>Версия формы</strong>. Тип значения: «Дата». Дата, когда форма была загружена.</li></ul><h3>Табличная часть "Принадлежность"   </h3>
<ul><li><strong>Имя объекта</strong>. Тип значения: «Строка». Тип документа на который распространяется печатная форма или обработка заполнения. 
</li><li><strong>Имя табличной части</strong>. Тип значения: «Строка». Имя табличной части документа для которой будет вызыватся обработка заполнения. 
</li><li><strong>Отбор. </strong>Тип значение: «Строка». Текстовое представление отбора из настроек отбора печатных форм. </li></ul><p></p>
<p></p>
<h3>Формы</h3>
<ul><li><strong>Форма списка</strong>. Основная форма списка и выбора. Используется для отображения списка или выбора элементов. 
</li><li><strong>Форма элемента</strong>. Основная форма объекта. Используется для заполнения обязательных реквизитов. 
</li><li><strong>Форма группы</strong>. Основная форма группы. Используется для заполнения обязательных реквизитов группы. Нельзя создать группу на первом уровне иерархии.</li></ul><p></p>
<p></p>
<h3>Способ вызова</h3>
<p class="Usual">Вызывается из меню <font color="#800000">"Справочники --&gt;Структура компании--&gt;Внешние печатные формы"</font>.</p>
<p class="Usual"><strong><font size="2"></font></strong> </p>
<p class="Usual"><strong><font size="2">Дополнительная информация.</font></strong></p>
<p class="Usual"><em><font size="1">Внешние отчеты и обработки служат для решения тех же задач, что и объекты типов "Отчеты" и "Обработки", но в отличие от них не входят в состав конфигурации, а могут быть сохранены в отдельных файлах.<br>Примером применения таких объектов могут быть обработки, предоставляющие дополнительные функции, расширяющие основные сервисные функции конфигурации, периодически изменяющиеся формы отчетности (например регламентированной), универсальные обработки, которые могут быть использованы в различных конфигурациях.</font> </em></p>
<p class="Usual"><font size="1"><font size="2"><font size="1">Справочник "Внешние печатные формы" содержит предопределённые группы.</font></font></font></p>
<ul><li>
<div class="Usual"><font size="1">Внешние обработки</font></div>
</li><li>
<div>Внешние отчеты</div>
</li><li>
<div>Внешние печатные формы</div>
</li><li>
<div>Внешние обработки заполнения табличных частей</div></li></ul><p class="Usual"><font size="1">Форматы файлов ассоциируемые с соответствующей группой справочника:</font></p>
<ul><li>
<div><font size="1">Группа "Внешние обработки" - загружаемые файлы должны иметь расширение "*.epf"(файл внешней обработки).</font></div>
</li><li>
<div><font size="1">Группа "Внешние отчеты" - загружаемые файлы должны иметь расширение "*.erf"(файл внешнего отчета).</font></div>
</li><li>
<div><font size="1">Группа "Внешние печатные формы" - загружаемые файлы должны иметь расширение "*.epf", либо "*.erf"(файл внешней обработки, либо файл внешнего отчета).</font></div>
</li><li>
<div><font size="1">
<div><font size="1">Группа "Внешние обработки заполнения табличных частей" - загружаемые файлы должны иметь расширение "*.epf"(файл внешней обработки).</font></div></font></div></li></ul><p class="Usual"><font size="1">Параметры хранения файла внешней обработки:</font></p>
<ul><li>
<div class="Usual"><font size="1"><font size="2">Хранить обработку в базе данных</font>.<strong> </strong>Файлы хранятся в базе данных. При выборе данного типа хранения файла доступны операции с файлом "Загрузить", "Выгрузить" и "Очистить". Операция "Загрузить" - загружает выбранный файл в базу данных, операция "Выгрузить" - выгружает файл в указанную директорию, с сохранением копии файла в базе данных, операция "Очистить" - удаляет файл из базы данных.</font></div>
</li><li>
<div class="Usual"><font size="2">Хранить обработку в файле. </font><font size="1">Хранятся пути к внешним файлам. При выборе данного типа хранения файла, доступно поле для ввода пути к внешнему файлу, указав директорию где хранится данный файл. </font></div></li></ul><font size="2">
<p class="Usual"><font size="2"><strong></strong></font> </p>
<p class="Usual"><font size="2"><strong>Внешние обработки:</strong></font></p>
<p class="Usual"><font size="1"><strong>Требования к созданию внешних обработок:</strong></font></p>
<ul><li><font size="1">Файл создаётся на базе "Внешней обработки". </font></li></ul></font>
<p class="Usual"><strong><font size="2"></font></strong> </p>
<p><strong><font size="2">Внешние отчеты:</font></strong></p>
<p class="Usual">Требования к созданию внешних отчетов:</p>
<ul><li>
<div class="Usual"><font size="1">Файл создаётся на базе "Внешнего отчета". </font></div></li></ul><p class="Usual"><font size="2"><strong></strong></font> </p>
<p class="Usual"><font size="2"><strong>Внешние печатные формы:</strong></font></p>
<p class="Usual"><font size="1">Требования к созданию внешних печатных форм:</font></p>
<ul><li>
<div><font size="1">Файл создаётся на базе внешней обработки, либо на базе внешнего отчета. </font></div>
</li><li>
<div><font size="1">Модуль объекта должен содержать прототип функции "Печать". </font></div>
</li><li>
<div><font size="1">Дополнительных форм для внешней печатной формы не требуется. </font></div></li></ul><p class="Usual"><font size="1">Пример содержимого модуля объекта внешней печатной формы приведен ниже.</font> </p>
<p class="Usual"> </p>
<p class="Usual">ПРИМЕР КОДА МОДУЛЯ ОБЪЕКТА:</p>
<p class="Usual"> </p>
<p class="SourceCode">// Параметры функции:<br>// ДокументОбъект - Документ - Документ для которого вызывается процедура печати.<br>// ТабДокумент - Табличный документ - табличный документ.<br>// Возвращаемое значение:<br>// ТабДокумент - возвращает сформированный табличный документ.<br>// Формирует печатную форму "ИмяПечатнойФормы"<br>// Возвращает сформированный табличный документ:<br>Функция Печать(ДокументОбъект, ТабДокумент) Экспорт</p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr" class="SourceCode">
<p class="SourceCode"> // Примеры получения макетов печатных форм<br> Макет = ПолучитьМакет("ИмяМакета"); // Получаем макет находящийся в самой внешней печатной форме.<br> Макет = ПолучитьОбщийМакет("ИмяМакета"); // Получаем макет находящийся в ветке "Общие" конфигурации.<br> ...</p>
<p class="SourceCode"> // Устанавливаем параметры макета<br> ТабДокумент.ТолькоПросмотр = Истина;<br> ТабДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;<br> ...</p></blockquote>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr">
<p dir="ltr" class="SourceCode"><br> // Получаем область макета<br> ОбластьМакета = Макет.ПолучитьОбласть("ИмяОбласти");<br> // Устанавливаем значения параметров области<br> ОбластьМакета.Параметры.Параметр1 = ЗначениеДляПараметра;<br> ...<br> // Выводим область<br> ТабДокумент.Вывести(ОбластьМакета);<br> ...<br> <br> Возврат ТабДокумент;</p></blockquote>
<p dir="ltr" class="SourceCode">КонецФункции</p>
<p class="Usual"><font size="2"><strong>Внешние обработки заполнения табличных частей:</strong></font></p>
<p class="Usual"><font size="1">Требования к созданию внешних печатных форм:</font></p>
<ul><li>
<div><font size="1">Файл создаётся на базе внешней обработки. </font></div>
</li><li>
<div><font size="1">Модуль объекта должен содержать прототип функции "Заполнить". </font></div>
</li><li>
<div><font size="1">Дополнительных форм для внешней печатной формы не требуется. </font></div></li></ul><p class="Usual"><font size="1">Пример содержимого модуля объекта внешней печатной формы приведен ниже.</font> </p>
<p class="Usual"> </p>
<p class="Usual">ПРИМЕР КОДА МОДУЛЯ ОБЪЕКТА:</p>
<p class="Usual"> </p>
<p class="SourceCode">// Параметры функции:<br>// ДокументОбъект - Документ - Документ для которого вызывается процедура заполнения.<br>// ТабЧасть - Табличная часть документа - Заполняемая табличная часть.<br>// ЭтаФорма - Форма документа - Форма из которой вызвали обработку заполнения.<br><br>Функция Заполнить(ДокументОбъект, ТабЧасть, ЭтаФорма) Экспорт</p>
<blockquote style="MARGIN-RIGHT: 0px" dir="ltr" class="SourceCode">
<p class="SourceCode"> // Обработка заполнения, вызов формы обработки и т.д.</p></blockquote>
<p dir="ltr" class="SourceCode">КонецФункции</p></body></html>