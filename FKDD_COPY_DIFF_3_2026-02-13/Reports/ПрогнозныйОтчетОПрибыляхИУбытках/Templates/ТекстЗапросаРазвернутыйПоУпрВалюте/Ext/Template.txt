ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Выручка.Период, ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Себестоимость.Период, ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Доходы.Период, БюджетДоходовИРасходовОбороты_Расходы.Период)))
	КАК Период,
	
	ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Выручка.СуммаДоходУпрОборот, 0)
	КАК СуммаВыручка,
	
	ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Доходы.СуммаДоходУпрОборот,  0)
	КАК СуммаДополнительнаяВыручка,
	
	ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Выручка.СуммаДоходУпрОборот, 0) + ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Доходы.СуммаДоходУпрОборот, 0)
	КАК СуммаВыручкаВсего,
	
	ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Себестоимость.СуммаРасходУпрОборот, 0)
	КАК СуммаСебестоимость,  
	
	ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Выручка.СуммаДоходУпрОборот, 0) + ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Доходы.СуммаДоходУпрОборот, 0)
	- ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Себестоимость.СуммаРасходУпрОборот, 0)
	КАК ВаловаяПрибыль,
	
	ВЫБОР КОГДА (ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Выручка.СуммаДоходУпрОборот, 0) + ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Доходы.СуммаДоходУпрОборот, 0))<>0 ТОГДА
	( ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Выручка.СуммаДоходУпрОборот, 0) + ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Доходы.СуммаДоходУпрОборот, 0)
	- ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Себестоимость.СуммаРасходУпрОборот, 0) ) * 100 / (ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Выручка.СуммаДоходУпрОборот, 0) + ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Доходы.СуммаДоходУпрОборот, 0))
	ИНАЧЕ
		0
	КОНЕЦ КАК ПроцентПрибыли,
	
	ЕСТЬNULL(БюджетДоходовИРасходовОбороты_Расходы.СуммаРасходУпрОборот, 0) КАК ОперационныеЗатраты

ИЗ
	РегистрНакопления.БюджетДоходовИРасходов.Обороты(
		&ДатаНачала,
		&ДатаКонца,	Месяц,
		СценарийПланирования = &СценарийПланирования
			И СтатьяДоходовИРасходов.ВидСтатьи = &ВидСтатьиВыручка
			МЕТКА_Подразделение) КАК БюджетДоходовИРасходовОбороты_Выручка
			
	ПОЛНОЕ СОЕДИНЕНИЕ
		
	РегистрНакопления.БюджетДоходовИРасходов.Обороты(
		&ДатаНачала,
		&ДатаКонца,	Месяц,
		СценарийПланирования = &СценарийПланирования
			И СтатьяДоходовИРасходов.ВидСтатьи = &ВидСтатьиСебестоимость
			МЕТКА_Подразделение) КАК БюджетДоходовИРасходовОбороты_Себестоимость
	
	ПО БюджетДоходовИРасходовОбороты_Выручка.Период = БюджетДоходовИРасходовОбороты_Себестоимость.Период
	ПОЛНОЕ СОЕДИНЕНИЕ
				
	РегистрНакопления.БюджетДоходовИРасходов.Обороты(
		&ДатаНачала,
		&ДатаКонца,	Месяц,
		СценарийПланирования = &СценарийПланирования
			И СтатьяДоходовИРасходов.ВидСтатьи = &ВидСтатьиДоход
			МЕТКА_Подразделение) КАК БюджетДоходовИРасходовОбороты_Доходы
	
	ПО БюджетДоходовИРасходовОбороты_Выручка.Период = БюджетДоходовИРасходовОбороты_Доходы.Период
	ПОЛНОЕ СОЕДИНЕНИЕ
		
	РегистрНакопления.БюджетДоходовИРасходов.Обороты(
		&ДатаНачала,
		&ДатаКонца, Месяц,
		СценарийПланирования = &СценарийПланирования
			И СтатьяДоходовИРасходов.ВидСтатьи = &ВидСтатьиРасход
			МЕТКА_Подразделение) КАК БюджетДоходовИРасходовОбороты_Расходы
    
    ПО БюджетДоходовИРасходовОбороты_Выручка.Период = БюджетДоходовИРасходовОбороты_Расходы.Период
УПОРЯДОЧИТЬ ПО
	Период
ИТОГИ
	СУММА(СуммаВыручка),
	СУММА(СуммаДополнительнаяВыручка),
	СУММА(СуммаВыручкаВсего),
	СУММА(СуммаСебестоимость),
	СУММА(ВаловаяПрибыль),
	 ВЫБОР
		КОГДА СУММА(СуммаВыручкаВсего) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВаловаяПрибыль) / СУММА(СуммаВыручкаВсего) * 100
		КОНЕЦ КАК ПроцентПрибыли,
	СУММА(ОперационныеЗатраты)
ПО
	ОБЩИЕ,
	Период ПЕРИОДАМИ(Месяц, &ДатаНачала, &ДатаКонца)