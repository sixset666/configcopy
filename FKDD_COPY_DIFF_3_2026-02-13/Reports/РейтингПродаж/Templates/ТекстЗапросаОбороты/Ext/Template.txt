ВЫБРАТЬ РАЗРЕШЕННЫЕ
ТаблицаРегистра.КоличествоОборот КАК КоличествоОборот, //ПОКАЗАТЕЛЬ 
ТаблицаРегистра.КоличествоОборот / ТаблицаРегистра.Номенклатура.ОсновнаяЕдиницаИзмерения.Коэффициент КАК КоличествоОснОборот, //ПОКАЗАТЕЛЬ
ТаблицаРегистра.СуммаОборот КАК СуммаПродажСоСкидкойОборот, //ПОКАЗАТЕЛЬ_
ТаблицаРегистра.СебестоимостьОборот КАК СебестоимостьОборот, //ПОКАЗАТЕЛЬ
ТаблицаРегистра.СуммаСкидкиОборот КАК СуммаСкидкиОборот, //ПОКАЗАТЕЛЬ_
ТаблицаРегистра.СуммаОборот-ТаблицаРегистра.СебестоимостьОборот КАК СуммаТорговойНаценкиОборот, //ПОКАЗАТЕЛЬ
ТаблицаРегистра.СуммаУпрОборот КАК СуммаПродажСоСкидкойУпрОборот, //ПОКАЗАТЕЛЬ
ТаблицаРегистра.СебестоимостьУпрОборот КАК СебестоимостьУпрОборот, //ПОКАЗАТЕЛЬ_
ТаблицаРегистра.СуммаУпрОборот-ТаблицаРегистра.СебестоимостьУпрОборот КАК СуммаТорговойНаценкиУпрОборот, //ПОКАЗАТЕЛЬ_
ВЫБОР КОГДА ЕСТЬNULL(ТаблицаРегистраОбщйОборот.СуммаОборот, 0)=0 ТОГДА 0 ИНАЧЕ (ТаблицаРегистра.СуммаОборот/ТаблицаРегистраОбщйОборот.СуммаОборот)*100 КОНЕЦ КАК ПроцентПродажВОбщемОборотеОборот, //ПОКАЗАТЕЛЬ_
ВЫБОР КОГДА ТаблицаРегистра.СебестоимостьУпрОборот=0 ТОГДА 0 ИНАЧЕ ((ТаблицаРегистра.СуммаУпрОборот-ТаблицаРегистра.СебестоимостьУпрОборот)/ТаблицаРегистра.СебестоимостьУпрОборот)*100 КОНЕЦ КАК ПроцентНаценкиОборот, //ПОКАЗАТЕЛЬ  
ВЫБОР КОГДА ЕСТЬNULL(ТаблицаРегистраОбщйОборот.СуммаТорговойНаценкиУпрОборот, 0)=0 ТОГДА 0 ИНАЧЕ ((ТаблицаРегистра.СуммаУпрОборот-ТаблицаРегистра.СебестоимостьУпрОборот)/ТаблицаРегистраОбщйОборот.СуммаТорговойНаценкиУпрОборот)*100 КОНЕЦ КАК ПроцентНаценкиВОбщемОборотеОборот, //ПОКАЗАТЕЛЬ
ВЫБОР КОГДА (ТаблицаРегистра.СуммаОборот+ТаблицаРегистра.СуммаСкидкиОборот)=0 ТОГДА 0 ИНАЧЕ (ТаблицаРегистра.СуммаСкидкиОборот/(ТаблицаРегистра.СуммаОборот+ТаблицаРегистра.СуммаСкидкиОборот))*100 КОНЕЦ КАК ПроцентСкидкиОборот, //ПОКАЗАТЕЛЬ  
ВЫБОР КОГДА ЕСТЬNULL(ТаблицаРегистраОбщйОборот.СуммаСкидкиОборот, 0)=0 ТОГДА 0 ИНАЧЕ (ТаблицаРегистра.СуммаСкидкиОборот/ТаблицаРегистраОбщйОборот.СуммаСкидкиОборот)*100 КОНЕЦ КАК ПроцентСкидокВОбщемОборотеОборот //ПОКАЗАТЕЛЬ
//СВОЙСТВА

{ВЫБРАТЬ 
#Область ИзмеренияПостроителяДляСвойств
	ТаблицаРегистра.ПодразделениеКомпании.Организация.* КАК Организация,
	ТаблицаРегистра.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	ТаблицаРегистра.Регистратор.Менеджер.* КАК Менеджер,
	ТаблицаРегистра.СкладКомпании.* КАК СкладКомпании,
	ТаблицаРегистра.ДокументПродажи.* КАК ДокументПродажи,
	ТаблицаРегистра.СтатусПартии.* КАК СтатусПартии,
	ТаблицаРегистра.Партия.* КАК Партия,
	ТаблицаРегистра.Номенклатура.ТипНоменклатуры.* КАК ТипНоменклатуры,
	ТаблицаРегистра.Номенклатура.* КАК Номенклатура,
	ТаблицаРегистра.ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры,
	ТаблицаРегистра.Поставщик.* КАК Поставщик,
	ТаблицаРегистра.Покупатель.* КАК Покупатель,
	ТаблицаРегистра.ДоговорВзаиморасчетов.* КАК ДоговорВзаиморасчетов,
	ТаблицаРегистра.ХозОперация.* КАК ХозОперация,
	ТаблицаРегистра.Регистратор.* КАК ПериодРегистратор,
#КонецОбласти	
	НачалоПериода(ТаблицаРегистра.Период, День) КАК ПериодДень ,
	НачалоПериода(ТаблицаРегистра.Период, Неделя) КАК ПериодНеделя ,
	НачалоПериода(ТаблицаРегистра.Период, Месяц) КАК ПериодМесяц ,
	НачалоПериода(ТаблицаРегистра.Период, Квартал) КАК ПериодКвартал ,
	НачалоПериода(ТаблицаРегистра.Период, Год) КАК ПериодГод 
//СВОЙСТВА
}
 ИЗ РегистрНакопления.Продажи.Обороты(&ДатаНач, &ДатаКон, Регистратор,{
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	СкладКомпании.* КАК СкладКомпании,
	ДокументПродажи.* КАК ДокументПродажи,
	СтатусПартии.* КАК СтатусПартии,
	Номенклатура.ТипНоменклатуры.* КАК ТипНоменклатуры,
	Номенклатура.* КАК Номенклатура,
	ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры,
	Поставщик.* КАК Поставщик,
	Покупатель.* КАК Покупатель,
	ДоговорВзаиморасчетов.* КАК ДоговорВзаиморасчетов,
	ХозОперация.* КАК ХозОперация}) КАК ТаблицаРегистра
	
	{ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
ТаблицаИтоговПродаж.СуммаОборот КАК СуммаОборот,
ТаблицаИтоговПродаж.СуммаУпрОборот-ТаблицаИтоговПродаж.СебестоимостьУпрОборот КАК СуммаТорговойНаценкиУпрОборот,
ТаблицаИтоговПродаж.СуммаСкидкиОборот КАК СуммаСкидкиОборот
ИЗ
	РегистрНакопления.Продажи.Обороты(&ДатаНач, &ДатаКон, ,{
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	СкладКомпании.* КАК СкладКомпании,
	ДокументПродажи.* КАК ДокументПродажи,
	СтатусПартии.* КАК СтатусПартии,
	Номенклатура.ТипНоменклатуры.* КАК ТипНоменклатуры,
	Номенклатура.* КАК Номенклатура,
	ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры,
	Поставщик.* КАК Поставщик,
	Покупатель.* КАК Покупатель,
	ДоговорВзаиморасчетов.* КАК ДоговорВзаиморасчетов,
	ХозОперация.* КАК ХозОперация}) КАК ТаблицаИтоговПродаж) КАК ТаблицаРегистраОбщйОборот
	ПО ИСТИНА}
//СОЕДИНЕНИЯ

{ГДЕ 
	ТаблицаРегистра.ПодразделениеКомпании.Организация.* КАК Организация,
	ТаблицаРегистра.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	ТаблицаРегистра.Регистратор.Менеджер.* КАК Менеджер,
	ТаблицаРегистра.СкладКомпании.* КАК СкладКомпании,
	ТаблицаРегистра.ДокументПродажи.* КАК ДокументПродажи,
	ТаблицаРегистра.СтатусПартии.* КАК СтатусПартии,
	ТаблицаРегистра.Партия.* КАК Партия,
	ТаблицаРегистра.Номенклатура.ТипНоменклатуры.* КАК ТипНоменклатуры,
	ТаблицаРегистра.Номенклатура.* КАК Номенклатура,
	ТаблицаРегистра.ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры,
	ТаблицаРегистра.Поставщик.* КАК Поставщик,
	ТаблицаРегистра.Покупатель.* КАК Покупатель,
	ТаблицаРегистра.ДоговорВзаиморасчетов.* КАК ДоговорВзаиморасчетов,
	ТаблицаРегистра.ХозОперация.* КАК ХозОперация,
	ТаблицаРегистра.Регистратор.* КАК ПериодРегистратор

//СВОЙСТВА
}
{УПОРЯДОЧИТЬ ПО 
	ТаблицаРегистра.ПодразделениеКомпании.Организация.* КАК Организация,
	ТаблицаРегистра.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	ТаблицаРегистра.Регистратор.Менеджер.* КАК Менеджер,
	ТаблицаРегистра.СкладКомпании.* КАК СкладКомпании,
	ТаблицаРегистра.ДокументПродажи.* КАК ДокументПродажи,
	ТаблицаРегистра.СтатусПартии.* КАК СтатусПартии,
	ТаблицаРегистра.Партия.* КАК Партия,
	ТаблицаРегистра.Номенклатура.ТипНоменклатуры.* КАК ТипНоменклатуры,
	ТаблицаРегистра.Номенклатура.* КАК Номенклатура,
	ТаблицаРегистра.ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры,
	ТаблицаРегистра.Поставщик.* КАК Поставщик,
	ТаблицаРегистра.Покупатель.* КАК Покупатель,
	ТаблицаРегистра.ДоговорВзаиморасчетов.* КАК ДоговорВзаиморасчетов,
	ТаблицаРегистра.ХозОперация.* КАК ХозОперация,
	ТаблицаРегистра.Регистратор.* КАК ПериодРегистратор,
	НачалоПериода(ТаблицаРегистра.Период, День) КАК ПериодДень ,
	НачалоПериода(ТаблицаРегистра.Период, Неделя) КАК ПериодНеделя ,
	НачалоПериода(ТаблицаРегистра.Период, Месяц) КАК ПериодМесяц ,
	НачалоПериода(ТаблицаРегистра.Период, Квартал) КАК ПериодКвартал ,
	НачалоПериода(ТаблицаРегистра.Период, Год) КАК ПериодГод,
	СуммаТорговойНаценкиУпрОборот, //ПОКАЗАТЕЛЬ_
	СуммаТорговойНаценкиОборот, //ПОКАЗАТЕЛЬ
	СуммаПродажСоСкидкойОборот, //ПОКАЗАТЕЛЬ_ 
	СуммаПродажСоСкидкойУпрОборот, //ПОКАЗАТЕЛЬ
	СебестоимостьОборот, //ПОКАЗАТЕЛЬ 
	СебестоимостьУпрОборот, //ПОКАЗАТЕЛЬ_ 
	КоличествоОборот, //ПОКАЗАТЕЛЬ 
	КоличествоОснОборот, //ПОКАЗАТЕЛЬ 
	СуммаСкидкиОборот, //ПОКАЗАТЕЛЬ_
	ПроцентСкидкиОборот //ПОКАЗАТЕЛЬ  	
//СВОЙСТВА
}
{ИТОГИ ПО 
	ТаблицаРегистра.ПодразделениеКомпании.Организация.* КАК Организация,
	ТаблицаРегистра.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	ТаблицаРегистра.Регистратор.Менеджер.* КАК Менеджер,
	ТаблицаРегистра.СкладКомпании.* КАК СкладКомпании,
	ТаблицаРегистра.ДокументПродажи.* КАК ДокументПродажи,
	ТаблицаРегистра.СтатусПартии.* КАК СтатусПартии,
	ТаблицаРегистра.Партия.* КАК Партия,
	ТаблицаРегистра.Номенклатура.ТипНоменклатуры.* КАК ТипНоменклатуры,
	ТаблицаРегистра.Номенклатура.* КАК Номенклатура,
	ТаблицаРегистра.ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры,
	ТаблицаРегистра.Поставщик.* КАК Поставщик,
	ТаблицаРегистра.Покупатель.* КАК Покупатель,
	ТаблицаРегистра.ДоговорВзаиморасчетов.* КАК ДоговорВзаиморасчетов,
	ТаблицаРегистра.ХозОперация.* КАК ХозОперация,
	ТаблицаРегистра.Регистратор.* КАК ПериодРегистратор,
	НачалоПериода(ТаблицаРегистра.Период, День) КАК ПериодДень ,
	НачалоПериода(ТаблицаРегистра.Период, Неделя) КАК ПериодНеделя ,
	НачалоПериода(ТаблицаРегистра.Период, Месяц) КАК ПериодМесяц ,
	НачалоПериода(ТаблицаРегистра.Период, Квартал) КАК ПериодКвартал ,
	НачалоПериода(ТаблицаРегистра.Период, Год) КАК ПериодГод

//СВОЙСТВА
}
ИТОГИ  
СУММА(КоличествоОборот), //ПОКАЗАТЕЛЬ 
СУММА(КоличествоОснОборот), //ПОКАЗАТЕЛЬ 
СУММА(СуммаПродажСоСкидкойОборот), //ПОКАЗАТЕЛЬ_ 
СУММА(СуммаПродажСоСкидкойУпрОборот), //ПОКАЗАТЕЛЬ
СУММА(СебестоимостьОборот), //ПОКАЗАТЕЛЬ
СУММА(СебестоимостьУпрОборот), //ПОКАЗАТЕЛЬ_
СУММА(СуммаСкидкиОборот), //ПОКАЗАТЕЛЬ_
СУММА(СуммаТорговойНаценкиУпрОборот), //ПОКАЗАТЕЛЬ_
СУММА(СуммаТорговойНаценкиОборот), //ПОКАЗАТЕЛЬ
ВЫРАЗИТЬ(СУММА(ПроцентПродажВОбщемОборотеОборот) КАК Число(15,4)) КАК ПроцентПродажВОбщемОборотеОборот, //ПОКАЗАТЕЛЬ_
ВЫРАЗИТЬ(ВЫБОР КОГДА СУММА(СебестоимостьУпрОборот)<=0 ТОГДА 0 ИНАЧЕ (СУММА(СуммаТорговойНаценкиУпрОборот)/СУММА(СебестоимостьУпрОборот))*100 КОНЕЦ КАК Число(15,4)) КАК ПроцентНаценкиОборот, //ПОКАЗАТЕЛЬ
ВЫРАЗИТЬ(СУММА(ПроцентНаценкиВОбщемОборотеОборот) КАК Число(15,4)) КАК ПроцентНаценкиВОбщемОборотеОборот, //ПОКАЗАТЕЛЬ  
ВЫРАЗИТЬ(ВЫБОР КОГДА (СУММА(СуммаПродажСоСкидкойОборот)+СУММА(СуммаСкидкиОборот))=0 ТОГДА 0 ИНАЧЕ (СУММА(СуммаСкидкиОборот)/(СУММА(СуммаПродажСоСкидкойОборот)+СУММА(СуммаСкидкиОборот)))*100 КОНЕЦ КАК Число(15,4)) КАК ПроцентСкидкиОборот, //ПОКАЗАТЕЛЬ  
ВЫРАЗИТЬ(СУММА(ПроцентСкидокВОбщемОборотеОборот) КАК Число(15,4)) КАК ПроцентСкидокВОбщемОборотеОборот //ПОКАЗАТЕЛЬ
//ИТОГИСВОЙСТВА

ПО ОБЩИЕ ,
	ТаблицаРегистра.ПодразделениеКомпании КАК ПодразделениеКомпании,
	ТаблицаРегистра.Номенклатура ИЕРАРХИЯ  КАК Номенклатура,
	ТаблицаРегистра.Покупатель КАК Покупатель
АВТОУПОРЯДОЧИВАНИЕ 
