ВЫБРАТЬ РАЗРЕШЕННЫЕ
	СУММА(ВнутреннийЗапрос.СуммаРегПланОборот) КАК СуммаРегПлановое,
	СУММА(ВнутреннийЗапрос.СуммаУпрПланОборот) КАК СуммаУпрПлановое,
	СУММА(ВнутреннийЗапрос.СуммаНДСПланОборот) КАК СуммаНДСПлановое,
	СУММА(ВнутреннийЗапрос.СебестоимостьУпрПланОборот) КАК СебестоимостьУпрПлановое,
	
	СУММА(ВнутреннийЗапрос.СуммаРегФактОборот) КАК СуммаРегФактическое,
	СУММА(ВнутреннийЗапрос.СуммаУпрФактОборот) КАК СуммаУпрФактическое,
	СУММА(ВнутреннийЗапрос.СуммаНДСФактОборот) КАК СуммаНДСФактическое,
	СУММА(ВнутреннийЗапрос.СебестоимостьУпрФактОборот) КАК СебестоимостьУпрФактическое,
	
	СУММА(ВнутреннийЗапрос.СуммаРегФактОборот) - СУММА(ВнутреннийЗапрос.СуммаРегПланОборот) КАК СуммаРегОтклонение,
	СУММА(ВнутреннийЗапрос.СуммаУпрФактОборот) - СУММА(ВнутреннийЗапрос.СуммаУпрПланОборот) КАК СуммаУпрОтклонение,
	СУММА(ВнутреннийЗапрос.СуммаНДСФактОборот) - СУММА(ВнутреннийЗапрос.СуммаНДСПланОборот) КАК СуммаНДСОтклонение,
	СУММА(ВнутреннийЗапрос.СебестоимостьУпрФактОборот) - СУММА(ВнутреннийЗапрос.СебестоимостьУпрПланОборот) КАК СебестоимостьУпрОтклонение,
	
	0 КАК СуммаРегПроцентОтклонения,
	0 КАК СуммаУпрПроцентОтклонения,
	0 КАК СуммаНДСПроцентОтклонения,
	0 КАК СебестоимостьУпрПроцентОтклонения
	
	//СВОЙСТВА

{ВЫБРАТЬ 
#Область ИзмеренияПостроителяДляСвойств
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	ТипНоменклатуры.* КАК ТипНоменклатуры, 	 
#КонецОбласти
	Период КАК Период
	//СВОЙСТВА}
    
ИЗ 
	(
	 ВЫБРАТЬ
	 	ЕСТЬNULL(БюджетПродажОбороты.СуммаРегОборот        , 0) КАК СуммаРегПланОборот,
	 	ЕСТЬNULL(БюджетПродажОбороты.СуммаУпрОборот        , 0) КАК СуммаУпрПланОборот,
	 	ЕСТЬNULL(БюджетПродажОбороты.СуммаНДСОборот        , 0) КАК СуммаНДСПланОборот,
	 	ЕСТЬNULL(БюджетПродажОбороты.СебестоимостьУпрОборот, 0) КАК СебестоимостьУпрПланОборот,
	 	
	  	ЕСТЬNULL(ПродажиОбороты.СуммаРегОборот        , 0) КАК СуммаРегФактОборот,
	 	ЕСТЬNULL(ПродажиОбороты.СуммаУпрОборот        , 0) КАК СуммаУпрФактОборот,
	 	ЕСТЬNULL(ПродажиОбороты.СуммаНДСОборот        , 0) КАК СуммаНДСФактОборот,
	 	ЕСТЬNULL(ПродажиОбороты.СебестоимостьУпрОборот, 0) КАК СебестоимостьУпрФактОборот,
		
	 	ЕСТЬNULL(БюджетПродажОбороты.ПодразделениеКомпании, ПродажиОбороты.ПодразделениеКомпании) КАК ПодразделениеКомпании,
	 	ЕСТЬNULL(БюджетПродажОбороты.Номенклатура, ПродажиОбороты.ТипНоменклатуры) КАК ТипНоменклатуры,
	 	ЕСТЬNULL(БюджетПродажОбороты.Период, НачалоПериода(ПродажиОбороты.Период, Месяц)) КАК Период
	
	 ИЗ
	 РегистрНакопления.БюджетПродаж.Обороты(&ДатаНач, &ДатаКон, Месяц, Номенклатура ССЫЛКА Справочник.ТипыНоменклатуры и СценарийПланирования = &СценарийПланирования {
		ПодразделениеКомпании.Организация.* КАК Организация, 
		ПодразделениеКомпании.* КАК ПодразделениеКомпании, 
		Номенклатура.* КАК ТипНоменклатуры
		}) КАК БюджетПродажОбороты
	   
	 ПОЛНОЕ СОЕДИНЕНИЕ
		
	(	ВЫБРАТЬ
	  	ПродажиОборотыНеСвернутые.ПодразделениеКомпании КАК ПодразделениеКомпании,
	  	ПродажиОборотыНеСвернутые.Номенклатура.ТипНоменклатуры КАК ТипНоменклатуры,
	  	ПродажиОборотыНеСвернутые.Период КАК Период,
	  	СУММА(ПродажиОборотыНеСвернутые.СуммаОборот) КАК СуммаРегОборот,
	  	СУММА(ПродажиОборотыНеСвернутые.СуммаУпрОборот) КАК СуммаУпрОборот,
	  	СУММА(ПродажиОборотыНеСвернутые.СуммаНДСОборот) КАК СуммаНДСОборот,
	  	СУММА(ПродажиОборотыНеСвернутые.СебестоимостьУпрОборот) КАК СебестоимостьУпрОборот
	  ИЗ
	  	РегистрНакопления.Продажи.Обороты(&ДатаНач, &ДатаКон, Месяц,{
		ПодразделениеКомпании.Организация.* КАК Организация, 
		ПодразделениеКомпании.* КАК ПодразделениеКомпании, 
		Номенклатура.ТипНоменклатуры.* КАК ТипНоменклатуры
		}) КАК ПродажиОборотыНеСвернутые
	  
	  СГРУППИРОВАТЬ ПО
	  	ПродажиОборотыНеСвернутые.ПодразделениеКомпании,
	  	ПродажиОборотыНеСвернутые.Номенклатура.ТипНоменклатуры,
	  	ПродажиОборотыНеСвернутые.Период	
	  ) КАК ПродажиОбороты 
		  
	 ПО БюджетПродажОбороты.ПодразделениеКомпании = ПродажиОбороты.ПодразделениеКомпании И БюджетПродажОбороты.Номенклатура = ПродажиОбороты.ТипНоменклатуры И БюджетПродажОбороты.Период = НачалоПериода(ПродажиОбороты.Период, Месяц)
	) КАК ВнутреннийЗапрос   
	//СОЕДИНЕНИЯ
	     	    
СГРУППИРОВАТЬ ПО
	ПодразделениеКомпании, 
	ТипНоменклатуры
	//СГРУППИРОВАТЬПО
	
{ГДЕ 
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	ТипНоменклатуры.* КАК ТипНоменклатуры
	 //СВОЙСТВА}
    
{УПОРЯДОЧИТЬ ПО 
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	ТипНоменклатуры.* КАК ТипНоменклатуры,
	Период КАК Период
	 //СВОЙСТВА}
    
{ИТОГИ ПО 
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	ТипНоменклатуры.* КАК ТипНоменклатуры,
	Период КАК Период
	 //СВОЙСТВА}
    
ИТОГИ  
	
	СУММА(СуммаРегПлановое),
	СУММА(СуммаУпрПлановое),
	СУММА(СуммаНДСПлановое),
	СУММА(СебестоимостьУпрПлановое),

	СУММА(СуммаРегФактическое),
	СУММА(СуммаУпрФактическое),
	СУММА(СуммаНДСФактическое),
	СУММА(СебестоимостьУпрФактическое),
	
	СУММА(СуммаРегОтклонение),
	СУММА(СуммаУпрОтклонение),
	СУММА(СуммаНДСОтклонение),
	СУММА(СебестоимостьУпрОтклонение),
	
	ВЫБОР КОГДА СУММА(СуммаРегПлановое)=0 ТОГДА 100 ИНАЧЕ СУММА(СуммаРегОтклонение) / СУММА(СуммаРегПлановое) * 100 КОНЕЦ КАК СуммаРегПроцентОтклонения,
	ВЫБОР КОГДА СУММА(СуммаУпрПлановое)=0 ТОГДА 100 ИНАЧЕ СУММА(СуммаУпрОтклонение) / СУММА(СуммаУпрПлановое) * 100 КОНЕЦ КАК СуммаУпрПроцентОтклонения,
	ВЫБОР КОГДА СУММА(СуммаНДСПлановое)=0 ТОГДА 100 ИНАЧЕ СУММА(СуммаНДСОтклонение) / СУММА(СуммаНДСПлановое) * 100 КОНЕЦ КАК СуммаНДСПроцентОтклонения,
	ВЫБОР КОГДА СУММА(СебестоимостьУпрПлановое)=0 ТОГДА 100 ИНАЧЕ СУММА(СебестоимостьУпрОтклонение) / СУММА(СебестоимостьУпрПлановое) * 100 КОНЕЦ КАК СебестоимостьУпрПроцентОтклонения

	//ИТОГИСВОЙСТВА
ПО 
	ОБЩИЕ
			
АВТОУПОРЯДОЧИВАНИЕ