ВЫБРАТЬ РАЗРЕШЕННЫЕ
	СУММА(ВнутреннийЗапрос.КоличествоПланОборот)       КАК КоличествоПлановое, 
	СУММА(ВнутреннийЗапрос.СуммаРегПланОборот)         КАК СуммаРегПлановое,
	СУММА(ВнутреннийЗапрос.СуммаУпрПланОборот)         КАК СуммаУпрПлановое,
	СУММА(ВнутреннийЗапрос.СуммаНДСПланОборот)         КАК СуммаНДСПлановое,
	СУММА(ВнутреннийЗапрос.КоличествоФактОборот)       КАК КоличествоФактическое,
	СУММА(ВнутреннийЗапрос.СуммаРегФактОборот)         КАК СуммаРегФактическое,
	СУММА(ВнутреннийЗапрос.СуммаУпрФактОборот)         КАК СуммаУпрФактическое,
	СУММА(ВнутреннийЗапрос.СуммаНДСФактОборот)         КАК СуммаНДСФактическое,
	СУММА(ВнутреннийЗапрос.КоличествоФактОборот)       - СУММА(ВнутреннийЗапрос.КоличествоПланОборот)       КАК КоличествоОтклонение,
	СУММА(ВнутреннийЗапрос.СуммаРегФактОборот)         - СУММА(ВнутреннийЗапрос.СуммаРегПланОборот)         КАК СуммаРегОтклонение,
	СУММА(ВнутреннийЗапрос.СуммаУпрФактОборот)         - СУММА(ВнутреннийЗапрос.СуммаУпрПланОборот)         КАК СуммаУпрОтклонение,
	СУММА(ВнутреннийЗапрос.СуммаНДСФактОборот)         - СУММА(ВнутреннийЗапрос.СуммаНДСПланОборот)         КАК СуммаНДСОтклонение,
	0 КАК КоличествоПроцентОтклонения,
	0 КАК СуммаРегПроцентОтклонения,
	0 КАК СуммаУпрПроцентОтклонения,
	0 КАК СуммаНДСПроцентОтклонения
           		
	//СВОЙСТВА

{ВЫБРАТЬ 
#Область ИзмеренияПостроителяДляСвойств
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	Номенклатура.ТипНоменклатуры.* КАК ТипНоменклатуры,
	Номенклатура.* КАК Номенклатура,
#КонецОбласти
	Период КАК Период
	//СВОЙСТВА}               
ИЗ 
	(
	 ВЫБРАТЬ
	 	ЕСТЬNULL(БюджетЗакупокОбороты.КоличествоОборот  , 0) КАК КоличествоПланОборот,
	 	ЕСТЬNULL(БюджетЗакупокОбороты.СуммаРегОборот    , 0) КАК СуммаРегПланОборот,
	 	ЕСТЬNULL(БюджетЗакупокОбороты.СуммаУпрОборот    , 0) КАК СуммаУпрПланОборот,
	 	ЕСТЬNULL(БюджетЗакупокОбороты.СуммаНДСОборот    , 0) КАК СуммаНДСПланОборот,
		 	
	 	ЕСТЬNULL(ПартииОбороты.КоличествоПриход         , 0) КАК КоличествоФактОборот,
	 	ЕСТЬNULL(ПартииОбороты.СуммаПриход              , 0) КАК СуммаРегФактОборот,
	 	ЕСТЬNULL(ПартииОбороты.СуммаУпрПриход           , 0) КАК СуммаУпрФактОборот,
	 	ЕСТЬNULL(ПартииОбороты.СуммаНДСПриход           , 0) КАК СуммаНДСФактОборот,
	 		
	 	ЕСТЬNULL(БюджетЗакупокОбороты.ПодразделениеКомпании, ПартииОбороты.СкладКомпании.Подразделение)  КАК ПодразделениеКомпании,
	 	ЕСТЬNULL(БюджетЗакупокОбороты.Номенклатура,          ПартииОбороты.Номенклатура)                 КАК Номенклатура,
	 	ЕСТЬNULL(БюджетЗакупокОбороты.Период,                НачалоПериода(ПартииОбороты.Период, Месяц)) КАК Период
	 		
	 ИЗ
	 
	 РегистрНакопления.БюджетЗакупок.Обороты(&ДатаНач, &ДатаКон, Месяц, Номенклатура ССЫЛКА Справочник.Номенклатура и СценарийПланирования = &СценарийПланирования{
		ПодразделениеКомпании.Организация.* КАК Организация, 
		ПодразделениеКомпании.*             КАК ПодразделениеКомпании, 
		Номенклатура.ТипНоменклатуры.*      КАК ТипНоменклатуры,
		Номенклатура.*                      КАК Номенклатура
		}) КАК БюджетЗакупокОбороты
	   
	 ПОЛНОЕ СОЕДИНЕНИЕ
	
	 РегистрНакопления.ПартииТоваровКомпании.Обороты(&ДатаНач, &ДатаКон, Месяц, {
		СкладКомпании.Подразделение.Организация.* КАК Организация, 
		СкладКомпании.Подразделение.*             КАК ПодразделениеКомпании, 
		Номенклатура.ТипНоменклатуры.*            КАК ТипНоменклатуры,
		Номенклатура.*                            КАК Номенклатура
		}) КАК ПартииОбороты
		                        		 	 		 
	 ПО БюджетЗакупокОбороты.ПодразделениеКомпании = ПартииОбороты.СкладКомпании.Подразделение И БюджетЗакупокОбороты.Номенклатура = ПартииОбороты.Номенклатура И БюджетЗакупокОбороты.Период = НачалоПериода(ПартииОбороты.Период, Месяц)
	) КАК ВнутреннийЗапрос 
	//СОЕДИНЕНИЯ
	     	    
СГРУППИРОВАТЬ ПО
	ПодразделениеКомпании, 
	Номенклатура
	//СГРУППИРОВАТЬПО
	
{ГДЕ 
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.*             КАК ПодразделениеКомпании,
	Номенклатура.ТипНоменклатуры.*      КАК ТипНоменклатуры,
	Номенклатура.*                      КАК Номенклатура
	 //СВОЙСТВА}
    
{УПОРЯДОЧИТЬ ПО 
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.*             КАК ПодразделениеКомпании,
	Номенклатура.ТипНоменклатуры.*      КАК ТипНоменклатуры,
	Номенклатура.*                      КАК Номенклатура,
	Период						   		КАК Период
	//СВОЙСТВА}
    
{ИТОГИ ПО 
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.*             КАК ПодразделениеКомпании,
	Номенклатура.ТипНоменклатуры.*      КАК ТипНоменклатуры,
	Номенклатура.*                      КАК Номенклатура,
	Период КАК Период
    //СВОЙСТВА}
    
ИТОГИ  
	СУММА(КоличествоПлановое),
	СУММА(СуммаРегПлановое),
	СУММА(СуммаУпрПлановое),
	СУММА(СуммаНДСПлановое),
	СУММА(КоличествоФактическое),
	СУММА(СуммаРегФактическое),
	СУММА(СуммаУпрФактическое),
	СУММА(СуммаНДСФактическое),
	СУММА(КоличествоОтклонение),
	СУММА(СуммаРегОтклонение),
	СУММА(СуммаУпрОтклонение),
	СУММА(СуммаНДСОтклонение),
	ВЫБОР КОГДА СУММА(КоличествоПлановое)=0 ТОГДА 100 ИНАЧЕ СУММА(КоличествоОтклонение) / СУММА(КоличествоПлановое) * 100 КОНЕЦ КАК КоличествоПроцентОтклонения,
	ВЫБОР КОГДА СУММА(СуммаРегПлановое)=0 ТОГДА 100 ИНАЧЕ СУММА(СуммаРегОтклонение) / СУММА(СуммаРегПлановое) * 100 КОНЕЦ КАК СуммаРегПроцентОтклонения,
	ВЫБОР КОГДА СУММА(СуммаУпрПлановое)=0 ТОГДА 100 ИНАЧЕ СУММА(СуммаУпрОтклонение) / СУММА(СуммаУпрПлановое) * 100 КОНЕЦ КАК СуммаУпрПроцентОтклонения,
	ВЫБОР КОГДА СУММА(СуммаНДСПлановое)=0 ТОГДА 100 ИНАЧЕ СУММА(СуммаНДСОтклонение) / СУММА(СуммаНДСПлановое) * 100 КОНЕЦ КАК СуммаНДСПроцентОтклонения
	//ИТОГИСВОЙСТВА
ПО 
	ОБЩИЕ
				
АВТОУПОРЯДОЧИВАНИЕ