
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	СУММА(ОбъединенныйЗапрос.КоличествоПланОборот)       КАК КоличествоПлановое,
	СУММА(ОбъединенныйЗапрос.СуммаРегПланОборот)         КАК СуммаРегПлановое,
	СУММА(ОбъединенныйЗапрос.СуммаУпрПланОборот)         КАК СуммаУпрПлановое,
	СУММА(ОбъединенныйЗапрос.СуммаНДСПланОборот)         КАК СуммаНДСПлановое,
	СУММА(ОбъединенныйЗапрос.СебестоимостьУпрПланОборот) КАК СебестоимостьУпрПлановое,
	
	СУММА(ОбъединенныйЗапрос.КоличествоФактОборот)       КАК КоличествоФактическое,
	СУММА(ОбъединенныйЗапрос.СуммаРегФактОборот)         КАК СуммаРегФактическое,
	СУММА(ОбъединенныйЗапрос.СуммаУпрФактОборот)         КАК СуммаУпрФактическое,
	СУММА(ОбъединенныйЗапрос.СуммаНДСФактОборот)         КАК СуммаНДСФактическое,
	СУММА(ОбъединенныйЗапрос.СебестоимостьУпрФактОборот) КАК СебестоимостьУпрФактическое,
	
	СУММА(ОбъединенныйЗапрос.КоличествоФактОборот       - ОбъединенныйЗапрос.КоличествоПланОборот)       КАК КоличествоОтклонение,
	СУММА(ОбъединенныйЗапрос.СуммаРегФактОборот         - ОбъединенныйЗапрос.СуммаРегПланОборот)         КАК СуммаРегОтклонение,
	СУММА(ОбъединенныйЗапрос.СуммаУпрФактОборот         - ОбъединенныйЗапрос.СуммаУпрПланОборот)         КАК СуммаУпрОтклонение,
	СУММА(ОбъединенныйЗапрос.СуммаНДСФактОборот         - ОбъединенныйЗапрос.СуммаНДСПланОборот)         КАК СуммаНДСОтклонение,
	СУММА(ОбъединенныйЗапрос.СебестоимостьУпрФактОборот - ОбъединенныйЗапрос.СебестоимостьУпрПланОборот) КАК СебестоимостьУпрОтклонение,
	
	0 КАК КоличествоПроцентОтклонения,
	0 КАК СуммаРегПроцентОтклонения,
	0 КАК СуммаУпрПроцентОтклонения,
	0 КАК СуммаНДСПроцентОтклонения,
	0 КАК СебестоимостьУпрПроцентОтклонения

	//СВОЙСТВА

{ВЫБРАТЬ 
#Область ИзмеренияПостроителяДляСвойств
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	ВариантКомплектации.* КАК ВариантКомплектации,
	Модель.* КАК Модель,
#КонецОбласти	
	Период КАК Период
	//СВОЙСТВА}
    
ИЗ 
	(
	 ВЫБРАТЬ
	 	БюджетПродажОбороты.ПодразделениеКомпании КАК ПодразделениеКомпании,
	 	БюджетПродажОбороты.Модель КАК Модель,
	 	БюджетПродажОбороты.ВариантКомплектации КАК ВариантКомплектации,
	 	БюджетПродажОбороты.Период КАК Период,
	 	
	 	БюджетПродажОбороты.КоличествоОборот       КАК КоличествоПланОборот, 
	 	БюджетПродажОбороты.СуммаРегОборот         КАК СуммаРегПланОборот,   
	 	БюджетПродажОбороты.СуммаУпрОборот         КАК СуммаУпрПланОборот,   
	 	БюджетПродажОбороты.СуммаНДСОборот         КАК СуммаНДСПланОборот,   
	 	БюджетПродажОбороты.СебестоимостьУпрОборот КАК СебестоимостьУпрПланОборот, 
	 	
	 	0 КАК КоличествоФактОборот, 
	 	0 КАК СуммаРегФактОборот,  
	 	0 КАК СуммаУпрФактОборот,  
	 	0 КАК СуммаНДСФактОборот,  
	 	0 КАК СебестоимостьУпрФактОборот                      
	
	 ИЗ
	 РегистрНакопления.БюджетПродажАвтомобилей.Обороты(&ДатаНач, &ДатаКон, Месяц, СценарийПланирования = &СценарийПланирования{
		ПодразделениеКомпании.Организация.* КАК Организация, 
		ПодразделениеКомпании.* КАК ПодразделениеКомпании, 
		Модель.* КАК Модель,
		ВариантКомплектации.* КАК ВариантКомплектации,
		ХозОперация.* КАК ХозОперация
		}) КАК БюджетПродажОбороты
	   
	 ОБЪЕДИНИТЬ ВСЕ
	 
	  ВЫБРАТЬ
	  	ПродажиОбороты.ПодразделениеКомпании,
	  	ПродажиОбороты.Автомобиль.Модель КАК Модель,
	 	ПродажиОбороты.Автомобиль.ВариантКомплектации КАК ВариантКомплектации,
		ПродажиОбороты.Период КАК Период,
		
	 	0 КАК КоличествоПланОборот,  
	 	0 КАК СуммаРегПланОборот,  
	 	0 КАК СуммаУпрПланОборот,  
	 	0 КАК СуммаНДСПланОборот,  
	 	0 КАК СебестоимостьУпрПланОборот,  
	 	
	 	ПродажиОбороты.КоличествоОборот       КАК КоличествоФактОборот,  
	 	ПродажиОбороты.СуммаОборот            КАК СуммаРегФактОборот,  
	 	ПродажиОбороты.СуммаУпрОборот         КАК СуммаУпрФактОборот,  
	 	ПродажиОбороты.СуммаНДСОборот         КАК СуммаНДСФактОборот,  
	 	ПродажиОбороты.СебестоимостьУпрОборот КАК СебестоимостьУпрФактОборот  
	 	
	 ИЗ
	 РегистрНакопления.ПродажиАвтомобилей.Обороты(&ДатаНач, &ДатаКон, Месяц, {
		ПодразделениеКомпании.Организация.* КАК Организация, 
		ПодразделениеКомпании.* КАК ПодразделениеКомпании, 
		Автомобиль.Модель.* КАК Модель,
	 	Автомобиль.ВариантКомплектации.* КАК ВариантКомплектации}) КАК ПродажиОбороты 
	) КАК ОбъединенныйЗапрос
//СОЕДИНЕНИЯ
	
СГРУППИРОВАТЬ ПО
	ОбъединенныйЗапрос.ПодразделениеКомпании,
	ОбъединенныйЗапрос.ВариантКомплектации,
	ОбъединенныйЗапрос.Модель,
	ОбъединенныйЗапрос.Период
	//СГРУППИРОВАТЬПО
	
 ИМЕЮЩИЕ
	&ВыводитьВсеЗаписи ИЛИ СУММА(ОбъединенныйЗапрос.КоличествоПланОборот)>0
	     	    
{ГДЕ 
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	Модель.* КАК Модель,
	ВариантКомплектации.* КАК ВариантКомплектации
	 //СВОЙСТВА}
    
{УПОРЯДОЧИТЬ ПО 
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	Модель.* КАК Модель,
	ВариантКомплектации.* КАК ВариантКомплектации,
	Период КАК Период
	 //СВОЙСТВА}
    
{ИТОГИ ПО 
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	Модель.* КАК Модель,
	ВариантКомплектации.* КАК ВариантКомплектации,
	Период КАК Период
    //СВОЙСТВА}
    
ИТОГИ  
	СУММА(КоличествоПлановое), 
	СУММА(СуммаРегПлановое), 
	СУММА(СуммаУпрПлановое), 
	СУММА(СуммаНДСПлановое), 
	СУММА(СебестоимостьУпрПлановое), 	
	
	СУММА(КоличествоФактическое), 
	СУММА(СуммаРегФактическое), 
	СУММА(СуммаУпрФактическое), 
	СУММА(СуммаНДСФактическое), 
	СУММА(СебестоимостьУпрФактическое), 	
	
	СУММА(КоличествоОтклонение),
	СУММА(СуммаРегОтклонение), 
	СУММА(СуммаУпрОтклонение), 
	СУММА(СуммаНДСОтклонение), 
	СУММА(СебестоимостьУпрОтклонение), 
	
	ВЫБОР КОГДА СУММА(КоличествоПлановое)=0 ТОГДА 100 ИНАЧЕ СУММА(КоличествоОтклонение)/СУММА(КоличествоПлановое) * 100 КОНЕЦ КАК КоличествоПроцентОтклонения,
	ВЫБОР КОГДА СУММА(СуммаРегПлановое)=0 ТОГДА 100 ИНАЧЕ СУММА(СуммаРегОтклонение) / СУММА(СуммаРегПлановое) * 100 КОНЕЦ КАК СуммаРегПроцентОтклонения,
	ВЫБОР КОГДА СУММА(СуммаУпрПлановое)=0 ТОГДА 100 ИНАЧЕ СУММА(СуммаУпрОтклонение) / СУММА(СуммаУпрПлановое) * 100 КОНЕЦ КАК СуммаУпрПроцентОтклонения,
	ВЫБОР КОГДА СУММА(СуммаНДСПлановое)=0 ТОГДА 100 ИНАЧЕ СУММА(СуммаНДСОтклонение) / СУММА(СуммаНДСПлановое) * 100 КОНЕЦ КАК СуммаНДСПроцентОтклонения,
	ВЫБОР КОГДА СУММА(СебестоимостьУпрПлановое)=0 ТОГДА 100 ИНАЧЕ СУММА(СебестоимостьУпрОтклонение) / СУММА(СебестоимостьУпрПлановое) * 100 КОНЕЦ КАК СебестоимостьУпрПроцентОтклонения
	//ИТОГИСВОЙСТВА
	
ПО ОБЩИЕ
				
АВТОУПОРЯДОЧИВАНИЕ
