<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"></meta><link rel="stylesheet" type="text/css" href="v8help://service_book/service_style"></link><meta name="GENERATOR" content="MSHTML 9.00.8112.16636"></meta></head><body>
<h1><font color="#000080">Обработки "Загрузка из файлов Microcat"</font></h1>
<h3>Назначение</h3>
<p class="Usual">Эта обработка позволяет производить загрузку номенклатуры деталей из систем <font color="#000080">Microcat®</font> и <font color="#000080">Microcat® LIVE™</font> с использованием файла обмена. При загрузки номенклатурных позиций новым элементам можно указать основные реквизиты для записи их в реквизиты номенклатуры.</p>
<p class="Usual">Относится к подсистеме: <a href="Subsystem.СтруктураКонфигурации.Subsystem.Обработки.Subsystem.ОбменДанными/Help">«Обмен данными»</a>.</p>
<p class="Usual"> </p>
<h3>Основные функции:</h3>
<ul><li>
<div class="usual">Загрузка данных файла в форму обработки следующих данных: каталожный номер номенклатуры, ее наименование и количество</div>
</li><li>
<div class="usual">Контроль наличия соответствующих элементов в справочнике "Номенклатура" , а также отображение остатки данной номенклатуры на складе, указанном в настройках обработки, или сводно по всем складам компании </div>
</li><li>
<div class="usual">Автоматизированная загрузка номенклатуры в табличную часть документа (при вызове обработки из формы документа)</div>
<div class="usual"></div>
</li><li>
<div class="usual">Загрузка данных: файл заказа сформированный в системе <font color="#000080">Microcat® LIVE™</font> и дальнейшего представления выгруженных заказов в виде списка.</div>
</li><li>
<div class="usual">Выгрузка данных: файл сформированный в системе «Альфа-Авто» содержащий информацию о контрагенте, автомобиле и информацию о номенклатуре имеющейся в нашей системе(остаток данной номенклатуры на складе, указанном в настройках обработки, или сводно по всем складам компании, цене данной номенклатуры по указанному типу)</div>
</li><li>
<div class="usual">Автоматизированное создание элементов в справочнике "Номенклатура".</div>
</li><li>
<div class="usual">Автоматизированное создание элементов в справочнике "Автоработы".</div>
</li><li>
<div class="usual">Автоматизированное создание нового заказа в системе  <font color="#000080">Microcat® LIVE™</font>. Для создания заказа требуется указать контрагента и автомобиль.</div>
<div></div></li></ul><p class="usual"> </p>
<h3>Описание настроек обработки</h3>
<ul><li>
<div class="head_usual"><span class="name2"><strong><font color="#000080">Источник данных</font></strong></span> – на данной закладке приведены настройки, определяющие структуру и правила формирования файла-источника данных, которые необходимы для корректной интерпретации содержащейся в нем информации.</div>
<ul><li>
<div class="usual"><span class="name1"><strong><font color="#800000">Каталог по умолчанию</font></strong></span> – папка на локальном жестком диске или в сети, в которой размещаются файлы выгрузки из системы Microcat®. Если заполнено, то каталог используется при открытии окна диалога выбора файла в основной форме обработки. Если не заполнено, то используется стандартный каталог, заданный в настройках 1С-Предприятие.</div>
</li><li>
<div class="usual"><span class="name1"><font color="#800000"><strong>Файл с разделителями</strong></font></span> – данные в строках файла разграничены символом-разделителем. При загрузке сам разделитель игнорируется. При выборе данного пункта становится доступной настройка «Разделитель» (см. далее)</div>
</li><li>
<div class="usual"><span class="name1"><font color="#800000"><strong>Разделитель</strong></font></span> – символ использующийся в качестве разделителя значений данных. Разделителем может быть любой текстовый символ или сочетание символов (не более 10) или символ «табуляция» (для выбора символа «табуляция» необходимо навести курсор мыши на поле разделитель, нажать правую кнопку, в открывшемся контекстном меню выбрать «Табулятор»).</div>
</li><li>
<div class="usual"><span class="name1"><strong><font color="#800000">Файл с полями фиксированной ширины</font></strong></span> – данные в строках размещаются одно за другим без использования разделителей. Ширина (количество символов) каждого из значений данных заранее известно. При выборе данного пункта становится доступной колонка «Ширина(симв.)» в таблице «Размещение полей данных в строке файла» (см. ниже)</div>
</li><li>
<div class="usual"><span class="name1"><strong><font color="#800000">Файл с колонтитулами</font></strong></span> – файл может содержать верхний или нижний (или оба) колонтитула, информация из которых должна быть проигнорирована программой при загрузке. При выборе данного пункта становятся доступными поля «Строки данных с» и «По» (см. далее)</div>
</li><li>
<div class="usual"><span class="name1"><strong><font color="#800000">«Строки данных с»</font></strong> и <strong><font color="#800000">«По»</font></strong></span> - диапазон номеров строк файла, в которых содержатся данные, подлежащие загрузке. Если значение «Строки данных с» 0, то считываются строки файла начиная с первой. Если значение «По» 0, то считываются строки файла до последней.</div>
</li><li>
<div class="usual"><span class="name1"><strong><font color="#800000">Размещение полей данных в строке файла</font></strong></span> – таблица, содержащая наименования полей данных, которые подлежат загрузке. Порядок расположения полей сверху вниз определяет порядок следования данных в строке файла слева направо. При выборе настройки «Файл с полями фиксированной ширины» (см.выше) становится видимой и доступной колонка «Ширина(симв.)», в которой необходимо указать ширину каждого из полей данных (по количеству символов).</div>
<div><em><strong>Замечание:</strong> Следует иметь ввиду, что в линейке конфигураций «Альфа-Авто: Автосалон+Автосервис+Автозапчасти ПРОФ, редакция 5.1» поле </em><a href="Catalog.Номенклатура/Help"><em>справочника "Номенклатура"</em></a><em> «Артикул» ограничено длиной 25 символов, а поле «Наименование» - 100 символов. Если в файле поля «Номер» или «Наименование» будут иметь ширину большую, чем эти значения, то при загрузке они будут автоматически «обрезаны».</em></div></li></ul></li><li>
<div class="head_usual"><span class="name2"><strong><font color="#000080">Номенклатура</font></strong></span> – на данной закладке приведены настройки, используемые как значения «по умолчанию» при отображении и автоматическом создании элементов справочника «Номенклатура», а также связанной с ним информации.</div>
<ul><li>
<div class="usual"><span class="name1"><strong><font color="#800000">Склад компании</font></strong></span> – элемент справочника <a href="Catalog.СкладыКомпании/Help">«Склады компании»</a> - склад, по которому отображаются остатки и резервы товаров в табличном поле обработки. Если не заполнено, то отображаются остатки по всем складам (сводно общей суммой) </div>
</li><li>
<div class="usual"><font color="#800000"><strong><span class="name1">Родитель</span> </strong></font>– группа номенклатуры, в которую записываются автоматически создаваемые элементы справочника <a href="Catalog.Номенклатура/Help">«Номенклатура»</a>. Если не заполнено, то новые элементы записываются в «корне» справочника. </div>
</li><li>
<div class="usual"><span class="name1"><strong><font color="#800000">Тип номенклатуры</font></strong></span> – значение типа <a href="Catalog.ТипыНоменклатуры/Help">«Типы номенклатуры»</a>, используется при автоматическом создании элементов справочника «Номенклатура». При выборе типа номенклатуры «Шины», «Диски» становится доступной гиперссылка «Свойства шин» (или «Свойства дисков»), при нажатии на которую открывается форма для указания соответствующих свойств, которые также будут установлены при создании новых элементов. </div>
</li><li>
<div class="usual"><span class="name1"><font color="#800000"><strong>Вид номенклатуры</strong></font></span> – элемент перечисления «Виды номенклатуры», используется при автоматическом создании элементов справочника «Номенклатура» </div>
</li><li>
<div class="usual"><span class="name1"><strong><font color="#800000">Базовая единица измерения</font></strong></span> – значение типа «<a href="Catalog.КлассификаторЕдиницИзмерения/Help">Классификатор единиц измерения</a>», используется при автоматическом создании элементов справочника «Номенклатура» </div>
</li><li>
<div class="usual"><span class="name1"><strong><font color="#800000">Валюта учета</font></strong></span> – значение типа «<a href="Catalog.Валюты/Help">Валюты</a>», используется при автоматическом создании элементов справочника <a href="Catalog.Номенклатура/Help">«Номенклатура»</a> </div>
</li><li>
<div class="usual"><span class="name1"><strong><font color="#800000">Ставка НДС</font></strong></span> – значение типа <a href="Catalog.СтавкиНДС/Help">«Ставки НДС»</a>, используется при автоматическом создании элементов справочника <a href="Catalog.Номенклатура/Help">«Номенклатура»</a> </div>
</li><li>
<div class="usual"><span class="name1"><strong><font color="#800000">Производитель</font></strong></span> – значение типа <a href="Catalog.Производители/Help">«Производители»</a>, используется при автоматическом создании элементов справочника <a href="Catalog.Номенклатура/Help">«Номенклатура»</a>. Если на закладке "Номенклатура" формы загрузки из Microcat указано "Использовать производителя модели автомобиля", то в карточку создаваемой номенклатуры будет подставлен производитель модели автомобиля из документа. </div>
</li><li>
<div class="usual"><span class="name1"><strong><font color="#800000">Страна происхождения</font></strong></span> – значение типа <a href="Catalog.КлассификаторСтранМира/Help">«Классификатор стран мира»</a>, используется при автоматическом создании элементов справочника <a href="Catalog.Номенклатура/Help">«Номенклатура»</a></div>
</li><li>
<div class="usual"><span class="name1"><strong><font color="#800000">Тип цены </font></strong></span>– элемент справочника <a href="Catalog.СкладыКомпании/Help">«Типы цен»</a>, в разрезе которого отображается цена товара. </div></li></ul></li><li>
<div class="usual"><span class="name2"><strong><font color="#000080">Устанавливать для новой автоработы</font></strong></span> – в данной группе приведены настройки, используемые как значения «по умолчанию» при отображении и автоматическом создании элементов справочника «Автоработы», а также связанной с ним информации.</div>
<div class="usual">
<ul><li>
<div class="usual"><span class="name1"><strong><font color="#800000">Нормочас работ - </font></strong></span>элемент справочника <a href="Catalog.СкладыКомпании/Help">«Нормочасы»</a>.</div></li></ul></div></li></ul><ul><li>
<div style="MARGIN-RIGHT: 0px"> <span class="name2"><strong><font color="#000080">Каталог - </font></strong></span> на данной закладке приведены параметры настройки каталога файлов, а также имена файлов сообщений.</div>
<ul><li>
<div style="MARGIN-RIGHT: 0px"><span class="name2"><span class="name2"><font color="#000080"><strong><font color="#800000">Каталог файлов</font> - </strong></font><font color="#000000">папка на локальном жестком диске или в сети, в которой размещаются файлы сообщений между системами <font color="#000080">Microcat® LIVE™</font> и  «Альфа-Авто»;</font></span></span></div>
</li><li>
<div style="MARGIN-RIGHT: 0px"><span class="name2"><span class="name2"><span class="name2"><span class="name2"><font color="#000080"><strong><font color="#800000">Имя</font> <font color="#800000">файла импорта</font>- </strong></font></span></span>указывается имя файла сообщения от системы <font color="#000080">Microcat® LIVE™</font>; </span></span></div>
</li><li>
<div style="MARGIN-RIGHT: 0px"><span class="name2"><span class="name2"><span class="name2"><span class="name2"><span class="name2"><span class="name2"><font color="#000080"><strong><span class="name2"><span class="name2"><span class="name2"><span class="name2"><font color="#000080"><strong><font color="#800000">Имя</font> <font color="#800000">файла экспорта </font></strong></font></span></span></span></span>-  </strong></font></span></span></span></span>указывается имя файла сообщения от системы «Альфа-Авто» в систему <font color="#000080">Microcat® LIVE™.</font></span></span></div></li></ul></li><li>
<div class="head_usual"> <span class="name2"><font color="#000080"><strong>Администрирование - </strong></font><font color="#000000">на данной закладке приведены параметры настройки времени ожидания сообщения от системы <font color="#000080">Microcat® LIVE™(</font> "таймаута") в случае инициации действия со стороны системы «Альфа-Авто»(создание нового заказа в системе <font color="#000080">Microcat® LIVE™</font></font><font color="#000000"> и т.п.). Также администрирование пользователей системы <font color="#000080">Microcat® LIVE™ </font></font><font color="#000000">(создание нового пользователя, восстановление утерянного пароля пользователя) </font></span></div>
<ul><li>
<div class="usual"><span class="name1"><font color="#800000"><strong>Таймаут - </strong></font><font color="#000000">время ожидания ответа от системы </font><font color="#000080">Microcat® LIVE™;</font></span></div>
</li><li>
<div class="usual"><span class="name1"><font color="#800000"><strong>Администрирование пользователей -</strong></font></span> работает в двух режимах:</div>
<ul><li>
<div class="usual">Добавление нового пользователя и восстановление пароля пользователя (данная функциональность имеет место в случае, если пользователь системы "1С:Предприятие" имеет "Административные" права);</div>
</li><li>
<div class="usual">Смена текущего пароля на новый в случае нарушения конфиденциальности пароля(данная функциональность имеест место в случае, если пользователь системы "1С:Предприятие" имеет ограниченные права).</div></li></ul></li></ul></li></ul><h3 class="para">Способ вызова</h3>
<p class="Usual">Вызывается по кнопке <font color="#800000">"Автокаталоги/Загрузка из автокаталога Microcat"</font> из формы списка справочника номенклатуры или из формы документа из командной панели табличной части "Товары" по кнопке <font color="#800000">"Заполнение/Загрузить из Microcat". </font></p>
<p class="Usual"> </p>
<p class="Usual"><font size="2"><strong>Варианты загрузки</strong></font></p>
<ul><li>
<div><strong>Загрузить из файла обмена - </strong>данный вариант загрузки используется в случае, если требуется использовать файловый вариант обмена. Руководство по настройке файлового варианта обмена приведено ниже.</div>
</li><li>
<div><strong>Загрузить из списка заказов - </strong>данный вариант загрузки используется в случае, когда в системе уже имеется список заказов и состав данного заказа(элементы состава: номенклатура и автоработы) требуется загрузить в документ.</div>
</li><li>
<div><strong>Загрузить автоматически -</strong> данный вариант загрузки используется в случае, если требуется получить файл заказа с использованием протокола MMP. Руководство по настройке варианта обмена, с использованием протокола MMP, приведено ниже.</div></li></ul><h3 class="para">Краткое руководство по настройке выгрузки при файловым варианте обмена в системах Microcat®, Microcat® LIVE™</h3>
<h3 class="USUAL"> </h3>
<p class="USUAL"><strong>Требования к формату файла выгрузки данных из систем Microcat®, Microcat® LIVE™</strong></p>
<ul><li>
<div class="usual">Файл должен иметь текстовый формат (*.txt)</div>
</li><li>
<div class="usual">Допускается наличие в файл верхнего и нижнего колонтитула. При загрузке информация колонтитула будет проигнорирована.</div>
</li><li>
<div class="usual">Данные по каждой позиции номенклатуры должны размещаться в отдельной строке</div>
</li><li>
<div class="usual">Каждая строка должна завершаться символом «Перевод стр.»</div>
</li><li>
<div class="usual">Если используется формат «Пакетный файл с разделителями», то все поля строки должны разделяться одинаковыми разделителями</div>
</li><li>
<div class="usual">В качестве разделителя полей не должны использоваться символы «Return» и «Перевод стр.»</div>
</li><li>
<div class="usual">В качестве разделителя может использоваться любой тестовый символ или строка символов длиной не более 10, а также символ табуляции «Tab»</div>
</li><li>
<div class="usual">Не рекомендуется использовать в качестве разделителя символ «,» (запятая), поскольку он может встречаться в наименованиях номенклатуры.</div>
</li><li>
<div class="usual">Если используется формат «Пакетный файл с полями равной ширины», то при указании ширины полей необходимо иметь ввиду ограничения «Альфа-авто»: Номер по каталогу – до 25 символов, Наименование номенклатуры – до 80 символов</div>
</li><li>
<div class="usual">Если используется формат «Пакетный файл с полями равной ширины», то разделителей в строке не должно быть. В противном случае они будут восприниматься при загрузке как часть данных.</div></li></ul><p class="usual"> </p>
<p class="Usual"><strong>Выгрузка данных</strong></p>
<p class="Usual">В системе <font color="#000080">Microcat®</font> возможно сохранить номенклатуру заказа в текстовый файл следующим способом:</p>
<ul><li>
<div class="usual">Создайте заказ в системе Microcat®</div>
</li><li>
<div class="usual">Откройте окно WorkBench</div>
</li><li>
<div class="usual">Нажмите  кнопку "Сохранить"</div>
</li><li>
<div class="usual">Укажите каталог и имя для сохраняемого файла</div></li></ul><p class="Usual">После выполнения указанных действий будет создан текстовый файл, в каждой строке которого будет указан каталожный номер номенклатуры и количество. При загрузке в "Альфа-авто 4" в настройке обработки <font color="#000080">"Загрузка из файлов Microcat"</font> следует выбрать формат пакетного файла <font color="#800000">"Файл с полями фиксированной ширины"</font></p>
<p class="Usual">В системе <font color="#000080">Microcat® LIVE™</font> перед выгрузкой необходимо задать необходимые настройки. Для этого следует выполнить следующие действия: </p>
<ul><li>
<div class="usual">Выберите пункт меню "Инструменты -&gt; Интегральные параметры настройки"</div>
</li><li>
<div class="usual">В открывшемся окне нажмите кнопку "Добавить новое соединение"</div>
</li><li>
<div class="usual">Выберите один из пунктов раздела "Пакетный файл". Система предлагает два варианта:</div>
<ul><li>
<div class="usual">"Запишите файл, содержащий перечень запчастей, чтобы поля были отделены разделителями"</div>
</li><li>
<div class="usual">"Запишите файл, содержащий перечень запчастей, чтобы каждое поле имело фиксированную ширину"</div></li></ul></li><li>
<div class="usual">В открывшемся окне на закладке "Общее" задайте каталог и имя сохраняемого файла.</div>
</li><li>
<div class="usual">На последующих закладках задайте структуру и формат строк файла согласно требований приведенных выше</div>
</li><li>
<div class="usual">Сохраните настройку</div>
</li><li>
<div class="usual">Установите сохраненную настройку как используемую по умолчанию в меню "Инструменты -&gt; Системы управления дилеров -&gt; Ваша настройка"</div></li></ul><div class="usual">После настройки возможно сохранить заказ в файл:</div>
<ul><li>
<div class="usual">Сформируйте заказ</div>
</li><li>
<div class="usual">Откройте "Профили заказов", выберите требуемый заказ</div>
</li><li>
<div class="usual">Нажмите кнопку "Пересылка". Система сформирует текстовый файл согласно установленным Вами настройкам.</div></li></ul><p class="usual"> </p>
<div class="usual">
<h3 class="Usual">Краткое руководство по настройке выгрузки при варианте использования MMP протокола в системе Microcat® LIVE™</h3>
<h3 class="USUAL"> </h3>
<p class="USUAL"><strong>Требования к формату файла выгрузки данных из системы Microcat® LIVE™</strong></p>
<ul><li>
<div class="usual">Файл формата XML содержащий выгружаемые данные.</div></li></ul><p class="usual"> </p>
<p class="Usual"><strong>Выгрузка данных</strong></p>
<p class="Usual">В системе <font color="#000080">Microcat®</font> возможно сохранить номенклатуру заказа в файл формата XML следующим способом:</p>
<ul><li>
<div class="usual">Авторизуйтесь в системе, используя логин и пароль(меню "Инструменты"-&gt;Запустить);</div>
</li><li>
<div class="usual">Создайте заказ в системе Microcat® LIVE™</div>
</li><li>
<div class="usual">Нажмите  кнопку "Сохранить"</div>
</li><li>
<div class="usual">Выберите тип заказа, и нажмите кнопку "Пересылка".</div></li></ul><p class="Usual">После выполнения указанных действий будет создан файл формата XML в указанном каталоге. Файл автоматически обработается системой «Альфа-Авто» и при правильной структуре файла будет сформирован заказ с данными в списке, на закладке "Заказы из Микрокат". При выборе заказа из списка происходит переключение на закладку "Оформление заказа", имеющиеся на данной закладке реквизиты заполняются данными из заказа(Контрагент, Автомобиль, состав заказа). На основании заполненных данных из заказа создаются документы по выбору(выбор осуществляется на закладке "Документы").</p>
<p class="Usual"> </p>
<p class="Usual">В системе <font color="#000080">Microcat® LIVE™</font> перед выгрузкой необходимо задать необходимые настройки. Для этого следует выполнить следующие действия: </p>
<ul><li>
<div class="usual">Выберите пункт меню "Инструменты -&gt; Интегральные параметры настройки"</div>
</li><li>
<div class="usual">В открывшемся окне нажмите кнопку "Добавить новое соединение"</div>
</li><li>
<div class="usual">Выберите пункт "Запишите файлы, содержащие сообщения MMP, для связи с СУД"  раздела "Протокол обмена сообщениями Microcat(MMP)". </div>
</li><li>
<div class="usual">Нажмите кнопку "Далее".</div>
</li><li>
<div class="usual">На закладке "Общее", в пункте "Параметры соединения" укажите пути к каталогам импорта и экспорта(указать один каталог для файлов импорта и экспорта) и имена файлов импорта и экспорта.</div>
</li><li>
<div class="usual">На закладке "Вход", в пункте "Запрашивать параметры" выберете пункт "Запрашивать перед входом имя пользователя и пароль".</div>
</li><li>
<div class="usual">На закладке "Дополнительно", в пункте "Опции интеграции" установить галочки напротив надписей "Автоматический запрос запчасти на дисплее" и "Интегрировать расценки СУД в заказе". Полосу регулирования "Время запроса истекает после:" установить в значение 30 и более.</div></li></ul></div></body></html>