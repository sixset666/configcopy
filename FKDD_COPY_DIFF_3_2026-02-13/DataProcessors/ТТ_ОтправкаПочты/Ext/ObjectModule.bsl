Процедура ОтправитьEmail(Получатели,Тема="",ТекстПисьма="",ФайлыВложений=Неопределено,СлепыеПолучатели=неопределено) Экспорт
	
	Письмо = Новый ИнтернетПочтовоеСообщение;
	Письмо.ИмяОтправителя = СокрЛП("1С");
	Письмо.Отправитель="1cnews@techno-temp.ru";
	
	Для каждого Получатель из Получатели Цикл
		Письмо.Получатели.Добавить(Получатель);	
	КонецЦикла;	
	
	если не слепыеПолучатели = неопределено тогда
	Для каждого стр из СлепыеПолучатели цикл
		Письмо.СлепыеКопии.Добавить(стр);
	КонецЦикла;
	конецЕсли;
	//Получатель.Адрес = Получатель;
	Письмо.Тема = Тема;
	Письмо.Тексты.Добавить(ТекстПисьма);
	
	Если ФайлыВложений<>Неопределено Тогда
		Для Каждого ФЛ из ФайлыВложений Цикл
			Письмо.Вложения.Добавить(ФЛ);
		КонецЦикла;
	КонецЕсли;
	
	ПрофильОтправки = Новый ИнтернетПочтовыйПрофиль;
	ПрофильОтправки.АдресСервераSMTP = "mail.techno-temp.ru";
	//ПрофильОтправки.АдресСервераPOP3 = "mail.tempauto.net";
	ПрофильОтправки.АутентификацияSMTP = СпособSMTPАутентификации.БезАутентификации;
	ПрофильОтправки.Пользователь = "1cnews"; 
	//ПрофильОтправки.ПользовательSMTP = "1cnews";
	//ПрофильОтправки.ПарольSMTP = "Jj123456";//"334578hz";   //Jj123456
	ПрофильОтправки.ПортSMTP=25; 
	//ПрофильОтправки.АутентификацияPOP3 = СпособPOP3Аутентификации.Обычная;
	//ПрофильОтправки.POP3ПередSMTP=Истина;
	
	Почта = Новый ИнтернетПочта;
	Попытка
		Почта.Подключиться(ПрофильОтправки);
	Исключение
		Сообщить("Электронное сообщение не отправлено: "+ОписаниеОшибки());
		Возврат;
	КонецПопытки;
	
	Попытка
		Почта.Послать(Письмо);
	Исключение
		Попытка
			Почта.Послать(Письмо);
		Исключение
			Сообщить("Электронное сообщение не отправлено: "+ОписаниеОшибки());
			Возврат;
		КонецПопытки;	
	КонецПопытки;
	
	Почта.Отключиться();		
	
КонецПроцедуры


Функция ОпределитьСклад(НаДату, Авто)
	ЗапросОстатки = Новый Запрос("ВЫБРАТЬ
|	ОстаткиАвтомобилейОстатки.СкладКомпании
|ИЗ
|	РегистрНакопления.ОстаткиАвтомобилей.Остатки(&НаДату, Автомобиль = &Авто) КАК ОстаткиАвтомобилейОстатки");
	ЗапросОстатки.УстановитьПараметр("НаДату", НаДату);
	ЗапросОстатки.УстановитьПараметр("Авто", Авто);
	ТаблицаСклад = ЗапросОстатки.Выполнить().Выгрузить();
	Попытка 
		Склад = ТаблицаСклад[0].СкладКомпании
	Исключение
		Склад = Справочники.СкладыКомпании.ПустаяСсылка();
	КонецПопытки;
	Возврат Склад;
КонецФункции

Процедура ОповещениеНезакрытыхЗН() Экспорт
	СостоянияЗН=Новый СписокЗначений;
	СостоянияЗН.Добавить(справочники.ВидыСостоянийЗаказНарядов.Закрыт);
	СостоянияЗН.Добавить(справочники.ВидыСостоянийЗаказНарядов.НайтиПоКоду("ЦБ00000001")); //Отказ от ремонта
	СостоянияЗН.Добавить(справочники.ВидыСостоянийЗаказНарядов.НайтиПоКоду("ЦБ00000007")); //для истории автомобиля

	
	ВидРемонтаИскл = Новый СписокЗначений;	
	ВидРемонтаИскл.Добавить(Справочники.ВидыРемонта.НайтиПоКоду("ЦБ000033")); //Сервисный клиентский заказ
	ВидРемонтаИскл.Добавить(Справочники.ВидыРемонта.НайтиПоКоду("ЦБ000034")); //Сервисный клиентский заказ с НДС
	ВидРемонтаИскл.Добавить(Справочники.ВидыРемонта.НайтиПоКоду("ЦБ000037")); // Техническое обслуживание
	ВидРемонтаИскл.Добавить(Справочники.ВидыРемонта.НайтиПоКоду("ЦБ000038")); // Техническое обслуживание с НДС
	
	ВидРемонтаИскл.Добавить(Справочники.ВидыРемонта.НайтиПоКоду("ЦБ000010")); // Гарантийный заказ	
	ВидРемонтаИскл.Добавить(Справочники.ВидыРемонта.НайтиПоКоду("ЦБ000011")); // Гарантийный заказ с НДС	
	ВидРемонтаИскл.Добавить(Справочники.ВидыРемонта.НайтиПоКоду("ЦБ000005")); // Возмещение ТУ
	ВидРемонтаИскл.Добавить(Справочники.ВидыРемонта.НайтиПоКоду("ЦБ000006")); // Возмещение ТУ с НДС
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ЗаказНаряд.Номер,
	|	ЗаказНаряд.Дата,
	|	ЗаказНаряд.Автомобиль,
	|	ЗаказНаряд.Заказчик,
	|	ЗаказНаряд.ВидРемонта,
	|	РеализацияАвтомобилейАвтомобили.Ссылка
	|ИЗ
	|	Документ.РеализацияАвтомобилей.Автомобили КАК РеализацияАвтомобилейАвтомобили
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ЗаказНаряд КАК ЗаказНаряд
	|		ПО РеализацияАвтомобилейАвтомобили.Автомобиль = ЗаказНаряд.Автомобиль
	|			И (НЕ ЗаказНаряд.Состояние В (&Состояния))
	|			И (ЗаказНаряд.Дата < РеализацияАвтомобилейАвтомобили.Ссылка.Дата)
	|ГДЕ
	|	РеализацияАвтомобилейАвтомобили.Ссылка.Дата > &ДатаОтсчета
	|	И РеализацияАвтомобилейАвтомобили.Ссылка.Проведен = ИСТИНА
	|	И ЗаказНаряд.ПометкаУдаления = ЛОЖЬ
	|	И НЕ ЗаказНаряд.ВидРемонта В (&ВидРемонтаИскл)
	|	И ЗаказНаряд.Организация В(&ОрганизацияСписок)";
	
	Запрос.УстановитьПараметр("ВидРемонтаИскл", ВидРемонтаИскл);
	//Запрос.УстановитьПараметр("ДатаОтсчета", ТекущаяДата()- 365*24*60*60);
	Запрос.УстановитьПараметр("ДатаОтсчета", Дата(2020,05,01));
	Запрос.УстановитьПараметр("Состояния", СостоянияЗН);
	ОрганизацияСписок = Новый СписокЗначений();
	ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000002")); //Техно-Темп
	ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000016")); //Кунова
	ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000004")); //ТАС
	ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000001"));//ТАК
	ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000003"));//Меридиан
	ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000009"));//ФКДД
	
	Запрос.УстановитьПараметр("ОрганизацияСписок", ОрганизацияСписок);
	
	Результат = Запрос.Выполнить();
	Если НЕ Результат.Пустой() Тогда
		ТекстПисьма="Незакрытые заказ-наряды по проданным автомобилям:" + " " + СтрокаСоединенияИнформационнойБазы();
		ВыборкаДетальныеЗаписи = Результат.Выбрать();
		
		Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
			ТекстПисьма=ТекстПисьма+"
			|
			|Номер З-Н: "+ВыборкаДетальныеЗаписи.Номер+"; Дата: "+ВыборкаДетальныеЗаписи.Дата+"; Заказчик: "+ 
			ВыборкаДетальныеЗаписи.Заказчик+"; Автомобиль: "+ВыборкаДетальныеЗаписи.Автомобиль+"; Вид ремонта: "+ВыборкаДетальныеЗаписи.ВидРемонта+"; Реализация: "+ВыборкаДетальныеЗаписи.Ссылка;	
		КонецЦикла;
		
		
		//отправка
		Тема = "Оповещение о незакрытых заказах-нарядах по проданным автомобилям. ООО Техно-Темп";
		Получатели = Новый Массив;
		Получатели.Добавить("f.konovalov@techno-temp.ru");
		Получатели.Добавить("a.karlin@techno-temp.ru");
		Получатели.Добавить("o.kunova@techno-temp.ru");
		Получатели.Добавить("g.glonti@techno-temp.ru");
		//Получатели.Добавить("d.senikov@techno-temp.ru");
		Получатели.Добавить("m.docenko@techno-temp.ru");
		//Получатели.Добавить("i.evseev@techno-temp.ru");
		Получатели.Добавить("m.klimeshin@techno-temp.ru");
		
		//Получатели.Добавить("a.luchin@techno-temp.ru");
		Получатели.Добавить("r.suvorov@techno-temp.ru");
		Получатели.Добавить("e.cheprasov@techno-temp.ru");
		Получатели.Добавить("v.chernyshev@techno-temp.ru");
		Получатели.Добавить("a.butorin@techno-temp.ru");
		Получатели.Добавить("n.lapshina@techno-temp.ru");
		
		
		Получатели.Добавить("e.pavluchenko@techno-temp.ru");
		Получатели.Добавить("e.moskvitin@techno-temp.ru");
		
		СлепыеПолучатели = Новый Массив;
		//СлепыеПолучатели.Добавить("o.kunova@techno-temp.ru");
		//СлепыеПолучатели.Добавить("1c_prog@tempauto.net");
		
		ТекстПисьма=ТекстПисьма+"
		|
		|
		|Сформировано автоматически. ООО Техно-Темп "+ТекущаяДата();
		ОтправитьEmail(Получатели,Тема,ТекстПисьма,,СлепыеПолучатели);	
		
	КонецЕсли;	
	
КонецПроцедуры

Процедура ОповещениеДеньВдень() Экспорт
	СостоянияЗакрыт=Справочники.ВидыСостоянийЗаказНарядов.Закрыт;
	
	ВнутрКонтраг= Новый СписокЗначений;
	ВнутрКонтраг.Добавить(Справочники.Контрагенты.НайтиПоКоду("ЦБ000433"));   	//TT
	//ВнутрКонтраг.Добавить(Справочники.Контрагенты.НайтиПоКоду("ЦБ007393"));     //ТАК
	//ВнутрКонтраг.Добавить(Справочники.Контрагенты.НайтиПоКоду("ЦБ211345"));     //Темп Авто ФКДД ООО
	ВнутрКонтраг.Добавить(Справочники.Контрагенты.НайтиПоКоду("ЦБ000447"));     //INT_SERV
	ВнутрКонтраг.Добавить(Справочники.Контрагенты.НайтиПоКоду("ЦБ043484"));     //INT_SERV
	ВнутрКонтраг.Добавить(Справочники.Контрагенты.НайтиПоКоду("ЦБ022077"));     //INT_SERV
	ВнутрКонтраг.Добавить(Справочники.Контрагенты.НайтиПоКоду("ЦБ230421"));     //INT_SERV
	
	ВидРемонтаДоп = Новый СписокЗначений;	
	ВидРемонтаДоп.Добавить(Справочники.ВидыРемонта.НайтиПоКоду("00000001")); //дополнительное оборудование
	ВидРемонтаДоп.Добавить(Справочники.ВидыРемонта.НайтиПоКоду("ЦБ000014")); //дополнительное оборудование с НДС

	ВидРемонтаДоп.Добавить(Справочники.ВидыРемонта.НайтиПоКоду("00000002")); //комплектация автомобиля
	ВидРемонтаДоп.Добавить(Справочники.ВидыРемонта.НайтиПоКоду("ЦБ000016")); //компл автомобиля для ОПА
	//<<Павличенко 15.10.2020 
	//ВидРемонтаДоп.Добавить(Справочники.ВидыРемонта.НайтиПоКоду("ЦБ000017")); //Комплектация автомобиля К
	//>>Павличенко 15.10.2020
	ВидРемонтаДоп.Добавить(Справочники.ВидыРемонта.НайтиПоКоду("ЦБ000018"));//Комплектация автомобиля П
	ВидРемонтаДоп.Добавить(Справочники.ВидыРемонта.НайтиПоКоду("ЦБ000019"));//Комплектация автомобиля П для ОПА
	//<<Павличенко 15.10.2020
 	ВидРемонтаДопКомплектация = Новый СписокЗначений;	
	ВидРемонтаДопКомплектация.Добавить(Справочники.ВидыРемонта.НайтиПоКоду("ЦБ000017")); //Комплектация автомобиля К

	Запрос = Новый Запрос("ВЫБРАТЬ
	                      |	ВложенныйЗапрос.Ссылка КАК Ссылка,
	                      |	ВложенныйЗапрос.Автомобиль КАК Автомобиль,
	                      |	ВложенныйЗапрос.ДатаПродажи,
	                      |	ВложенныйЗапрос.ДатаЗакрытия КАК ДатаЗакрытия,
	                      |	ВложенныйЗапрос.ВидРемонта
	                      |ИЗ
	                      |	(ВЫБРАТЬ
	                      |		ЕСТЬNULL(ПродажиАвтомобилейОбороты.ДокументПродажи.Дата, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)) КАК ДатаПродажи,
	                      |		ЗаказНаряды.Ссылка КАК Ссылка,
	                      |		ЗаказНаряды.Автомобиль КАК Автомобиль,
	                      |		ЗаказНаряды.ДатаЗакрытия КАК ДатаЗакрытия,
	                      |		ЗаказНаряды.ВидРемонта КАК ВидРемонта
	                      |	ИЗ
	                      |		(ВЫБРАТЬ
	                      |			ЗаказНаряд.Ссылка КАК Ссылка,
	                      |			ЗаказНаряд.Автомобиль КАК Автомобиль,

	                      |			ЗаказНаряд.ДатаЗакрытия КАК ДатаЗакрытия,
	                      |			ЗаказНаряд.ВидРемонта КАК ВидРемонта
	                      |		ИЗ
	                      |			Документ.ЗаказНаряд КАК ЗаказНаряд



	                      |		ГДЕ
	                      |			ЗаказНаряд.Состояние = &Состояние
	                      |			И ЗаказНаряд.ПометкаУдаления = ЛОЖЬ
	                      |			И ЗаказНаряд.ВидРемонта В(&ВидРемонтаДОПКомплектация)
	                      |			И ЗаказНаряд.ДатаЗакрытия > &ДатаОтсчета
	                      |			И ЗаказНаряд.Организация В(&ОрганизацияСписок)
	                      |		
	                      |		ОБЪЕДИНИТЬ ВСЕ
	                      |		
	                      |		ВЫБРАТЬ
	                      |			ЗаказНаряд.Ссылка,
	                      |			ЗаказНаряд.Автомобиль,
	                      |			ЗаказНаряд.ДатаЗакрытия,
	                      |			ЗаказНаряд.ВидРемонта
	                      |		ИЗ
	                      |			Документ.ЗаказНаряд КАК ЗаказНаряд
	                      |		ГДЕ
	                      |			ЗаказНаряд.Состояние = &Состояние
	                      |			И ЗаказНаряд.ПометкаУдаления = ЛОЖЬ
	                      |			И ЗаказНаряд.ВидРемонта В(&ВидРемонтаДоп)
	                      |			И ЗаказНаряд.Заказчик В(&ВнутрКонтраг)
	                      |			И ЗаказНаряд.ДатаЗакрытия > &ДатаОтсчета
	                      |			И ЗаказНаряд.Организация В(&ОрганизацияСписок)) КАК ЗаказНаряды
	                      |			ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ПродажиАвтомобилей.Обороты КАК ПродажиАвтомобилейОбороты
	                      |			ПО ЗаказНаряды.Автомобиль = ПродажиАвтомобилейОбороты.Автомобиль
	                      |				И (НАЧАЛОПЕРИОДА(ЗаказНаряды.ДатаЗакрытия, ДЕНЬ) = НАЧАЛОПЕРИОДА(ПродажиАвтомобилейОбороты.ДокументПродажи.Дата, ДЕНЬ))) КАК ВложенныйЗапрос
	                      |ГДЕ
	                      |	ВложенныйЗапрос.ДатаПродажи = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	                      |
	                      |УПОРЯДОЧИТЬ ПО
	                      |	ДатаЗакрытия,
	                      |	Автомобиль,
	                      |	Ссылка");
	ОрганизацияСписок = Новый СписокЗначений();
	ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000002")); //Техно-Темп
	ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000016")); //Кунова
	ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000004")); //ТАС
	ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000001"));//ТАК
	ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000003"));//Меридиан
	ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000009"));//ФКДД
	
	Запрос.УстановитьПараметр("Состояние", Справочники.ВидыСостоянийЗаказНарядов.Закрыт);
	Запрос.УстановитьПараметр("ДатаОтсчета", Дата(2020,05,01));
	Запрос.УстановитьПараметр("ВидРемонтаДоп", ВидРемонтаДоп);
	
	//<<Павличенко 15.10.2020
	Запрос.УстановитьПараметр("ВидРемонтаДопКомплектация", ВидРемонтаДопКомплектация);

	
	//Запрос = Новый Запрос("ВЫБРАТЬ
	//                      |	ВложенныйЗапрос.Ссылка КАК Ссылка,
	//                      |	ВложенныйЗапрос.Автомобиль КАК Автомобиль,
	//                      |	ВложенныйЗапрос.ДатаПродажи,
	//                      |	ВложенныйЗапрос.ДатаЗакрытия КАК ДатаЗакрытия,
	//                      |	ВложенныйЗапрос.ВидРемонта
	//                      |ИЗ
	//                      |	(ВЫБРАТЬ
	//                      |		ЗаказНаряд.Ссылка КАК Ссылка,
	//                      |		ЗаказНаряд.Автомобиль КАК Автомобиль,
	//                      |		ЕСТЬNULL(ПродажиАвтомобилейОбороты.ДокументПродажи.Дата, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)) КАК ДатаПродажи,
	//                      |		ЗаказНаряд.ДатаЗакрытия КАК ДатаЗакрытия,
	//                      |		ЗаказНаряд.ВидРемонта КАК ВидРемонта
	//                      |	ИЗ
	//                      |		Документ.ЗаказНаряд КАК ЗаказНаряд
	//                      |			ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ПродажиАвтомобилей.Обороты КАК ПродажиАвтомобилейОбороты
	//                      |			ПО ЗаказНаряд.Автомобиль = ПродажиАвтомобилейОбороты.Автомобиль
	//                      |				И (НАЧАЛОПЕРИОДА(ЗаказНаряд.ДатаЗакрытия, ДЕНЬ) = НАЧАЛОПЕРИОДА(ПродажиАвтомобилейОбороты.ДокументПродажи.Дата, ДЕНЬ))
	//                      |	ГДЕ
	//                      |		ЗаказНаряд.Состояние = &Состояние
	//                      |		И ЗаказНаряд.ПометкаУдаления = ЛОЖЬ
	//                      |		И ЗаказНаряд.ВидРемонта В(&ВидРемонтаДоп)
	//                      |		И ЗаказНаряд.Заказчик В(&ВнутрКонтраг)
	//                      |		И ЗаказНаряд.ДатаЗакрытия > &ДатаОтсчета
	//                      |		И ЗаказНаряд.Организация В(&ОрганизацияСписок)) КАК ВложенныйЗапрос
	//                      |ГДЕ
	//                      |	ВложенныйЗапрос.ДатаПродажи = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	//                      |
	//                      |УПОРЯДОЧИТЬ ПО
	//                      |	ДатаЗакрытия,
	//                      |	Автомобиль,
	//                      |	Ссылка");
	//ОрганизацияСписок = Новый СписокЗначений();
	//ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000002")); //Техно-Темп
	//ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000016")); //Кунова
	//ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000004")); //ТАС
	//ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000001"));//ТАК
	//ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000003"));//Меридиан
	//ОрганизацияСписок.Добавить(Справочники.Организации.НайтиПоКоду("ЦБ000009"));//ФКДД
	//
	//Запрос.УстановитьПараметр("Состояние", Справочники.ВидыСостоянийЗаказНарядов.Закрыт);
	//Запрос.УстановитьПараметр("ДатаОтсчета", Дата(2020,05,01));
	//Запрос.УстановитьПараметр("ВидРемонтаДоп", ВидРемонтаДоп);
	//>>Павличенко 15.10.2020
	
	Запрос.УстановитьПараметр("ВнутрКонтраг", ВнутрКонтраг);
	Запрос.УстановитьПараметр("ОрганизацияСписок", ОрганизацияСписок);

	Результат = Запрос.Выполнить().Выгрузить();
	
	Если Результат.Количество() > 0 Тогда
		ТекстПисьма="Не закрытые день в день с реализацией авто заказ-наряды:" + " " + СтрокаСоединенияИнформационнойБазы();		
		Для Каждого СтрокаЗапроса ИЗ Результат Цикл
			СкладНаДатуЗакрытия = ОпределитьСклад(СтрокаЗапроса.ДатаЗакрытия, СтрокаЗапроса.Ссылка.Автомобиль);
			Если Найти(СкладНаДатуЗакрытия.Наименование, "тест-драйв")<>0 тогда
				Продолжить;
			КонецЕсли;	
			ТекстПисьма=ТекстПисьма+"
			|
			|Номер З-Н: "+СтрокаЗапроса.Ссылка.Номер+"; Дата: "+СтрокаЗапроса.Ссылка.Дата+"; Заказчик: "+ 
		СтрокаЗапроса.Ссылка.Заказчик+"; Автомобиль: "+СтрокаЗапроса.Ссылка.Автомобиль+"; Вид ремонта: "+СтрокаЗапроса.Ссылка.ВидРемонта + "; Склад: " + СкладНаДатуЗакрытия;
		КонецЦикла;
		
		
		Тема = "Оповещение о не закрытых день в день с реализацией авто заказ-нарядах. ООО Техно-Темп";
		Получатели = Новый Массив;
		
		Получатели.Добавить("f.konovalov@techno-temp.ru");
		Получатели.Добавить("a.karlin@techno-temp.ru");
		Получатели.Добавить("o.kunova@techno-temp.ru");
		Получатели.Добавить("g.glonti@techno-temp.ru");
		//Получатели.Добавить("d.senikov@techno-temp.ru");
		Получатели.Добавить("m.docenko@techno-temp.ru");
		//Получатели.Добавить("i.evseev@techno-temp.ru");
		Получатели.Добавить("m.klimeshin@techno-temp.ru");
		
		//Получатели.Добавить("a.luchin@techno-temp.ru");
		Получатели.Добавить("r.suvorov@techno-temp.ru");
		Получатели.Добавить("e.cheprasov@techno-temp.ru");
		Получатели.Добавить("v.chernyshev@techno-temp.ru");
		Получатели.Добавить("a.butorin@techno-temp.ru");
		Получатели.Добавить("n.lapshina@techno-temp.ru");
		Получатели.Добавить("e.pavluchenko@techno-temp.ru");
		Получатели.Добавить("e.moskvitin@techno-temp.ru");
		СлепыеПолучатели = Новый Массив;
		//СлепыеПолучатели.Добавить("e.pavluchenko@tempauto.net");
		//СлепыеПолучатели.Добавить("m@chuvin.ru");
		//СлепыеПолучатели.Добавить("1c_prog@tempauto.net");
		
		ТекстПисьма=ТекстПисьма+"
		|
		|
		|Сформировано автоматически. ООО Техно-Темп "+ТекущаяДата();
		ОтправитьEmail(Получатели,Тема,ТекстПисьма,,СлепыеПолучатели);	
		
	КонецЕсли;	
	
КонецПроцедуры
