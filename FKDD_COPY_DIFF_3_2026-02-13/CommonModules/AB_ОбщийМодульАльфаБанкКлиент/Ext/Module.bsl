Процедура ПровестиЧекЧерезАльфаБанк(Форма,ПараметрыДействия, Объект = Неопределено) Экспорт
	
	Если ПараметрыДействия = Неопределено Тогда
		ПараметрыДействия = Новый Структура;
	КонецЕсли;
	ПараметрыДействия.Вставить("Форма",Форма);
	ПараметрыДействия.Вставить("Объект",Форма.ЭтотОбъект);
	
	//Проверки
	Если НЕ ЗначениеЗаполнено(Объект.Ссылка) Тогда 
		Сообщить("Документ не записан!");
		Возврат;
	КонецЕсли;
	
	Если Объект.Модифицированность() Тогда
		Сообщить("Документ не записан!");
		Возврат;
	КонецЕсли;
	
	Если Объект.AB_ЧерезАльфаБанк = Истина Тогда
		Сообщить("Документ уже оплачен через Альфа-Банк!");
		Возврат;
	КонецЕсли;
	
	//Проверка что по документу не ведется уже работа
	ТекущаяСессия = AB_ОбщийМодульАльфаБанкСервер.ПроверитьДоступностьТерминала(,,Объект.Ссылка);
	Если ТекущаяСессия <> Неопределено И ТекущаяСессия <> Истина Тогда 
		Если ТекущаяСессия.Пользователь <> ПараметрыСеанса.Пользователь тогда
			Сообщить("С данным документом уже работает пользователь <"+ТекущаяСессия.Пользователь+">");
			Возврат;
		КонецЕсли;
	КонецЕсли;
	
	//Проверка что  у пользователя нет открытых сессий
	ТекущаяСессия = AB_ОбщийМодульАльфаБанкСервер.ПроверитьДоступностьТерминала(,ПараметрыСеанса.Пользователь);
	Если ТекущаяСессия <> Неопределено И ТекущаяСессия <> Истина Тогда
		Если ТекущаяСессия.Документ <> Объект.Ссылка тогда 
			Сообщить("Текущий пользователь уже открыл сессию в документе <"+ТекущаяСессия.Документ+">");
			Возврат;
		КонецЕсли;
	КонецЕсли;
	
	ПараметрыФормы = Новый Структура;
	ПараметрыФормы.Вставить("РежимВыбора",Ложь);
	ПараметрыФормы.Вставить("ТекущийДокумент",Объект.Ссылка);
	Форма.ТолькоПросмотр = Истина; 
	
	ФормаТерминалов = ПолучитьФорму("ОбщаяФорма.AB_РаботаСТерминаломАльфаБанк",ПараметрыФормы,Форма);
	ФормаТерминалов.Открыть();
	
	
КонецПроцедуры // ПробитьЧек()