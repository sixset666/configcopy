
Функция ПолучитьФакт(НачПериода,КонПериода,ТекПериодичность,KPI,Сотрудник,ТекПодразделениеКомпании=Неопределено) Экспорт
	
	Запрос=Новый Запрос("ВЫБРАТЬ
	|	ФактическиеЗначенияKPI.Факт
	|ИЗ
	|	РегистрСведений.ФактическиеЗначенияKPI КАК ФактическиеЗначенияKPI
	|ГДЕ
	|	ФактическиеЗначенияKPI.Период МЕЖДУ &НачПериода И &КонПериода
	|	И ФактическиеЗначенияKPI.Сотрудник = &Сотрудник
	|	И ФактическиеЗначенияKPI.KPI = &KPI
	|	И (ФактическиеЗначенияKPI.ПодразделениеКомпании = &ПодразделениеКомпании
	|			ИЛИ &Все)");
	Запрос.УстановитьПараметр("НачПериода",НачПериода);
	Запрос.УстановитьПараметр("КонПериода",КонПериода);
	Запрос.УстановитьПараметр("Сотрудник",Сотрудник);
	Запрос.УстановитьПараметр("KPI",KPI);
	Запрос.УстановитьПараметр("Периодичность",ТекПериодичность);
	Запрос.УстановитьПараметр("ПодразделениеКомпании", текПодразделениеКомпании);
	Запрос.УстановитьПараметр("Все", ПустаяСтрока(текПодразделениеКомпании));
	
	ТЗ=Запрос.Выполнить().Выгрузить();
	
	Возврат ТЗ.Итог("Факт");
	
КонецФункции
