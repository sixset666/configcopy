Функция ДляСкдПолучитьПроценты(ДатаПоступления, НачалоПериода, КонецПериода, СуммаПартии, ДатаРеализации) Экспорт
	
	Если КонецПериода > Дата(2016,1,1) Тогда
		КолДнейВгоду =366;
	Иначе
		КолДнейВгоду =365;
	КонецЕсли;
	КонецПериода1 = КонецПериода;
	
	КолДнейВгоду = ДеньГода(КонецГода(КонецПериода1));
	
	ДатаПоступления = НачалоДня(ДатаПоступления);
	
	Если ДатаРеализации <> NULL Тогда
		КонецПериода = НачалоДня(ДатаРеализации);
	Иначе 
		КонецПериода = НачалоДня(КонецПериода);
	КонецЕсли;
	
	ПоследнийПроцент=0;
	Сумма = 0;
	
	
	Если ДатаПоступления>= НачалоПериода Тогда 
		НачПериод = ДатаПоступления;
	Иначе
		НачПериод = НачалоПериода;
	КонецЕсли;

	Запрос1 = Новый Запрос;
	Запрос1.Текст = 
	"ВЫБРАТЬ
	|	ПроцентыПоДатамСрезПоследних.Процент
	|ИЗ
	|	РегистрСведений.ПроцентыПоДатам.СрезПоследних(&ДатаПоступления, ) КАК ПроцентыПоДатамСрезПоследних";
	Запрос1.УстановитьПараметр("ДатаПоступления",ДатаПоступления); 
	Выборка1 = Запрос1.Выполнить().Выбрать();
	Пока выборка1.Следующий() Цикл
		ПоследнийПроцент= Выборка1.Процент;
	КонецЦикла;
	
	//Запрос= Новый Запрос;
	//Запрос.Текст = "ВЫБРАТЬ
	//|	ПроцентыПоДатам.Период,
	//|	ПроцентыПоДатам.Процент
	//|ИЗ
	//|	РегистрСведений.ПроцентыПоДатам КАК ПроцентыПоДатам
	//|ГДЕ
	//|	ПроцентыПоДатам.Период >= &ДатаПоступления";
	//Запрос.УстановитьПараметр("ДатаПоступления",НачПериод);
	//Выборка = Запрос.Выполнить().Выбрать();		

	//Пока Выборка.Следующий() И Выборка.Период <=КонецПериода  цикл
	//	
	//	КонПериод = Выборка.Период;	
	//	Сумма = Сумма + СуммаПартии * (ПоследнийПроцент/100) * ( (КонПериод - НачПериод)/(24*3600)/КолДнейВгоду ) ;
	//	
	//	НачПериод = КонПериод;
	//	ПоследнийПроцент = Выборка.Процент;
	//			
	//КонецЦикла;
	
	Сумма = Сумма + СуммаПартии * (ПоследнийПроцент/100) * ( (КонецПериода - НачПериод)/(24*3600)/КолДнейВгоду ) ;
	
	Возврат Окр(Сумма,2);
	
КонецФункции

Функция ДляСкдПолучитьПроцентыНаДату(ДатаПоступления, ДатаОтчета, СуммаПартии) Экспорт
	Если ДатаОтчета> Дата(2016,1,1)  Тогда
		КолДнейВгоду =366;
	Иначе
		КолДнейВгоду =365;
	КонецЕсли;	
	ДатаОтчета1 = ДатаОтчета;	
	КолДнейВгоду = ДеньГода(КонецГода(ДатаОтчета1));
	
	ДатаПоступления = НачалоДня(ДатаПоступления);
	ДатаОтчета = НачалоДня(ДатаОтчета);
	ПоследнийПроцент=0;
	Сумма = 0;
	НачПериод = ДатаПоступления;
	
	Запрос1 = Новый Запрос;
	Запрос1.Текст = 
	"ВЫБРАТЬ
	|	ПроцентыПоДатамСрезПоследних.Процент
	|ИЗ
	|	РегистрСведений.ПроцентыПоДатам.СрезПоследних(&ДатаПоступления, ) КАК ПроцентыПоДатамСрезПоследних";
	Запрос1.УстановитьПараметр("ДатаПоступления",ДатаПоступления); 
	Выборка1 = Запрос1.Выполнить().Выбрать();
	Пока выборка1.Следующий() Цикл
		ПоследнийПроцент= Выборка1.Процент;
	КонецЦикла;
	
	//Запрос= Новый Запрос;
	//Запрос.Текст = "ВЫБРАТЬ
	//|	ПроцентыПоДатам.Период,
	//|	ПроцентыПоДатам.Процент
	//|ИЗ
	//|	РегистрСведений.ПроцентыПоДатам КАК ПроцентыПоДатам
	//|ГДЕ
	//|	ПроцентыПоДатам.Период >= &ДатаПоступления";
	//Запрос.УстановитьПараметр("ДатаПоступления",ДатаПоступления);
	//Выборка = Запрос.Выполнить().Выбрать();		

	//Пока Выборка.Следующий() И Выборка.Период <=ДатаОтчета  цикл
	//	
	//	КонПериод = Выборка.Период;	
	//	Сумма = Сумма + СуммаПартии * (ПоследнийПроцент/100) * ( (КонПериод - НачПериод)/(24*3600)/КолДнейВгоду ) ;
	//	
	//	НачПериод = КонПериод;
	//	ПоследнийПроцент = Выборка.Процент;
	//			
	//КонецЦикла;
	
	Сумма = Сумма + СуммаПартии * (ПоследнийПроцент/100) * ( (ДатаОтчета - НачПериод)/(24*3600)/КолДнейВгоду ) ;
	
	Возврат Окр(Сумма,2);
	
КонецФункции

Функция ДляСкдПолучитьПроцДебет(Период, ДатаОтчета, СуммаЗадолж, Договор) Экспорт
	Если СуммаЗадолж =NULL или СуммаЗадолж =0 Тогда 
		Возврат 0 
	КонецЕсли;
	
	Если ДатаОтчета> Дата(2016,1,1)  Тогда
		КолДнейВгоду =366;
	Иначе
		КолДнейВгоду =365;
	КонецЕсли;	
	ДатаОтчета1 = ДатаОтчета;
	КолДнейВгоду = ДеньГода(КонецГода(ДатаОтчета1));
	
	Дата1 = НачалоДня(Период);
	ДатаОтчета = НачалоДня(ДатаОтчета);
	ПоследнийПроцент=0;
	Сумма = 0;
	НачПериод = Дата1;
	
	Запрос1 = Новый Запрос;
	Запрос1.Текст = 
	"ВЫБРАТЬ
	|	ПроцентыПоДатамСрезПоследних.Процент
	|ИЗ
	|	РегистрСведений.ПроцентыПоДатам.СрезПоследних(&НачПериод, ) КАК ПроцентыПоДатамСрезПоследних";
	Запрос1.УстановитьПараметр("НачПериод",НачПериод); 
	Выборка1 = Запрос1.Выполнить().Выбрать();
	Пока выборка1.Следующий() Цикл
		ПоследнийПроцент= Выборка1.Процент;
	КонецЦикла;
	
	////Вычисляем следующую дату изменения задолженности	
	//Запрос = Новый Запрос;
	//Запрос.Текст = 
	//"ВЫБРАТЬ ПЕРВЫЕ 2
	//|	ВзаиморасчетыКомпанииОстаткиИОбороты.Период
	//|ПОМЕСТИТЬ врем
	//|ИЗ
	//|	РегистрНакопления.ВзаиморасчетыКомпании.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, День, ,ДоговорВзаиморасчетов = &Договор ) КАК ВзаиморасчетыКомпанииОстаткиИОбороты
	//|
	//|УПОРЯДОЧИТЬ ПО
	//|	ВзаиморасчетыКомпанииОстаткиИОбороты.Период
	//|;
	//|
	//|////////////////////////////////////////////////////////////////////////////////
	//|ВЫБРАТЬ ПЕРВЫЕ 1
	//|	врем.Период КАК Период
	//|ИЗ
	//|	врем КАК врем
	//|
	//|УПОРЯДОЧИТЬ ПО
	//|	Период УБЫВ";
	//
	//Запрос.УстановитьПараметр("НачалоПериода", НачПериод);	
	//Запрос.УстановитьПараметр("КонецПериода", ДатаОтчета);
	//Запрос.УстановитьПараметр("Договор", Договор);

	//Результат = Запрос.Выполнить();
	//
	//ВыборкаДетальныеЗаписи = Результат.Выбрать();
	//
	//Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
	//	ДатаОтчета = ВыборкаДетальныеЗаписи.Период;	
	//КонецЦикла;	
	//
	//Запрос= Новый Запрос;
	//Запрос.Текст = "ВЫБРАТЬ
	//|	ПроцентыПоДатам.Период,
	//|	ПроцентыПоДатам.Процент
	//|ИЗ
	//|	РегистрСведений.ПроцентыПоДатам КАК ПроцентыПоДатам
	//|ГДЕ
	//|	ПроцентыПоДатам.Период >= &Дата1";
	//Запрос.УстановитьПараметр("Дата1",Дата1);
	//Выборка = Запрос.Выполнить().Выбрать();		

	//Пока Выборка.Следующий() И Выборка.Период <=ДатаОтчета  цикл
	//	
	//	КонПериод = Выборка.Период;	
	//	Сумма = Сумма + СуммаЗадолж * (ПоследнийПроцент/100) * ( (КонПериод - НачПериод)/(24*3600)/КолДнейВгоду ) ;
	//	
	//	НачПериод = КонПериод;
	//	ПоследнийПроцент = Выборка.Процент;
	//			
	//КонецЦикла;
	
	Сумма =  СуммаЗадолж * (ПоследнийПроцент/100) * ( 1/КолДнейВгоду ) ;
	
	Возврат Окр(Сумма,2);
	
КонецФункции

Функция ДляСкдПолучитьБрэнд(Элемент) Экспорт
	
	Если Элемент.Родитель.Пустая() Тогда
		Возврат Элемент;
	Иначе
		Возврат ДляСкдПолучитьБрэнд(Элемент.Родитель);
	КонецЕсли;
	
КонецФункции 

//++СнимченкоАА_бизтех++
Функция ДляСкд_GTIN(КодМаркировки) Экспорт  
	Если ЗначениеЗаполнено(КодМаркировки) Тогда
		ОбъектШК = Обработки.ШтрихКоды.Создать();
		СтруктураМаркировки = ОбъектШК.РазобратьСтрокуШтрихкодаGS1(КодМаркировки);
		Возврат СтруктураМаркировки.ДанныеШтрихкода["01"].Значение;  
	Иначе	
		Возврат "";
	КонецЕсли;
КонецФункции          
Функция ДляСкд_СерийныйНомер(КодМаркировки) Экспорт  
	Если ЗначениеЗаполнено(КодМаркировки) Тогда
		ОбъектШК = Обработки.ШтрихКоды.Создать();
		СтруктураМаркировки = ОбъектШК.РазобратьСтрокуШтрихкодаGS1(КодМаркировки);
		Возврат СтруктураМаркировки.ДанныеШтрихкода["21"].Значение;  
	Иначе	
		Возврат "";
	КонецЕсли;
КонецФункции          
//--СнимченкоАА_бизтех--
