ВЫБРАТЬ РАЗРЕШЕННЫЕ
СУММА(ПоказательПлана1Оборот) КАК ПоказательПлана1Оборот, //ПОКАЗАТЕЛЬ
СУММА(ПоказательПлана2Оборот) КАК ПоказательПлана2Оборот, //ПОКАЗАТЕЛЬ
СУММА(ПоказательПлана3Оборот) КАК ПоказательПлана3Оборот, //ПОКАЗАТЕЛЬ
СУММА(ПоказательФакта1Оборот) КАК ПоказательФакта1Оборот, //ПОКАЗАТЕЛЬ
СУММА(ПоказательФакта2Оборот) КАК ПоказательФакта2Оборот, //ПОКАЗАТЕЛЬ
СУММА(ПоказательФакта3Оборот) КАК ПоказательФакта3Оборот, //ПОКАЗАТЕЛЬ
СУММА(ПоказательПлана1Оборот-ПоказательФакта1Оборот) КАК Показатель1РазницаОборот, //ПОКАЗАТЕЛЬ
СУММА(ПоказательПлана2Оборот-ПоказательФакта2Оборот) КАК Показатель2РазницаОборот, //ПОКАЗАТЕЛЬ
СУММА(ПоказательПлана3Оборот-ПоказательФакта3Оборот) КАК Показатель3РазницаОборот, //ПОКАЗАТЕЛЬ
ВЫБОР КОГДА СУММА(ПоказательПлана1Оборот)<>0 ТОГДА СУММА(ПоказательПлана1Оборот - ПоказательФакта1Оборот) * 100 / СУММА(ПоказательПлана1Оборот) ИНАЧЕ 100 КОНЕЦ КАК Показатель1РазницаПроцентОборот, //ПОКАЗАТЕЛЬ
ВЫБОР КОГДА СУММА(ПоказательПлана2Оборот)<>0 ТОГДА СУММА(ПоказательПлана2Оборот - ПоказательФакта2Оборот) * 100 / СУММА(ПоказательПлана2Оборот) ИНАЧЕ 100 КОНЕЦ КАК Показатель2РазницаПроцентОборот, //ПОКАЗАТЕЛЬ
ВЫБОР КОГДА СУММА(ПоказательПлана3Оборот)<>0 ТОГДА СУММА(ПоказательПлана3Оборот - ПоказательФакта3Оборот)*100 / СУММА(ПоказательПлана3Оборот) ИНАЧЕ 100 КОНЕЦ КАК Показатель3РазницаПроцентОборот //ПОКАЗАТЕЛЬ

//СВОЙСТВА

{ВЫБРАТЬ 
#Область ИзмеренияПостроителяДляСвойств
    ПодразделениеКомпании.* КАК Подразделение,    
    ВидПлана.* КАК ВидПланаКомпании,
	ВидАналитикиПланирования1.* КАК ВидАналитикиПланирования1,
	ВидАналитикиПланирования2.* КАК ВидАналитикиПланирования2,
	Регистратор.* КАК ПериодРегистратор,
#КонецОбласти	
	НачалоПериода(Период, День) КАК ПериодДень ,
	НачалоПериода(Период, Неделя) КАК ПериодНеделя ,
	НачалоПериода(Период, Месяц) КАК ПериодМесяц ,
	НачалоПериода(Период, Квартал) КАК ПериодКвартал ,
	НачалоПериода(Период, Год) КАК ПериодГод 

//СВОЙСТВА
}
 ИЗ РегистрНакопления.Планирование.Обороты(&ДатаНач, &ДатаКон, Регистратор,{
	ПодразделениеКомпании.* КАК Подразделение,
	ВидПлана.* КАК ВидПланаКомпании,
	ВидАналитикиПланирования1.* КАК ВидАналитикиПланирования1,
	ВидАналитикиПланирования2.* КАК ВидАналитикиПланирования2}) КАК ТаблицаРегистра
//СОЕДИНЕНИЯ
СГРУППИРОВАТЬ ПО
	ПодразделениеКомпании,
	ВидПлана, 
	ВидАналитикиПланирования1,
	ВидАналитикиПланирования2

//СГРУППИРОВАТЬПО

{ГДЕ 
	ПодразделениеКомпании.* КАК Подразделение,
	ВидПлана.* КАК ВидПланаКомпании,
	ВидАналитикиПланирования1.* КАК ВидАналитикиПланирования1,
	ВидАналитикиПланирования2.* КАК ВидАналитикиПланирования2,
	Регистратор.* КАК ПериодРегистратор

//СВОЙСТВА
}
{УПОРЯДОЧИТЬ ПО 
	ПодразделениеКомпании.* КАК Подразделение,
	ВидПлана.* КАК ВидПланаКомпании,
	ВидАналитикиПланирования1.* КАК ВидАналитикиПланирования1,
	ВидАналитикиПланирования2.* КАК ВидАналитикиПланирования2,
	Регистратор.* КАК ПериодРегистратор,
	ПоказательПлана1Оборот, //ПОКАЗАТЕЛЬ
	ПоказательПлана2Оборот, //ПОКАЗАТЕЛЬ
	ПоказательПлана3Оборот, //ПОКАЗАТЕЛЬ
	ПоказательФакта1Оборот, //ПОКАЗАТЕЛЬ
	ПоказательФакта2Оборот, //ПОКАЗАТЕЛЬ
	ПоказательФакта3Оборот, //ПОКАЗАТЕЛЬ
	Показатель1РазницаОборот, //ПОКАЗАТЕЛЬ
	Показатель2РазницаОборот, //ПОКАЗАТЕЛЬ
	Показатель3РазницаОборот //ПОКАЗАТЕЛЬ
                                    
//СВОЙСТВА
}
{ИТОГИ ПО
	ПодразделениеКомпании.* КАК Подразделение, 
	ВидПлана.* КАК ВидПланаКомпании, 
	ВидАналитикиПланирования1.* КАК ВидАналитикиПланирования1,
	ВидАналитикиПланирования2.* КАК ВидАналитикиПланирования2,
	Регистратор.* КАК ПериодРегистратор,
	НачалоПериода(Период, День) КАК ПериодДень ,
	НачалоПериода(Период, Неделя) КАК ПериодНеделя ,
	НачалоПериода(Период, Месяц) КАК ПериодМесяц ,
	НачалоПериода(Период, Квартал) КАК ПериодКвартал ,
	НачалоПериода(Период, Год) КАК ПериодГод

//СВОЙСТВА
}
ИТОГИ  
СУММА(ПоказательПлана1Оборот), //ПОКАЗАТЕЛЬ
СУММА(ПоказательПлана2Оборот), //ПОКАЗАТЕЛЬ
СУММА(ПоказательПлана3Оборот), //ПОКАЗАТЕЛЬ
СУММА(ПоказательФакта1Оборот), //ПОКАЗАТЕЛЬ
СУММА(ПоказательФакта2Оборот), //ПОКАЗАТЕЛЬ
СУММА(ПоказательФакта3Оборот), //ПОКАЗАТЕЛЬ
СУММА(Показатель1РазницаОборот), //ПОКАЗАТЕЛЬ
СУММА(Показатель2РазницаОборот), //ПОКАЗАТЕЛЬ
СУММА(Показатель3РазницаОборот), //ПОКАЗАТЕЛЬ
ВЫБОР КОГДА СУММА(ПоказательПлана1Оборот)<>0 ТОГДА (СУММА(ПоказательПлана1Оборот) - СУММА(ПоказательФакта1Оборот)) * 100 / СУММА(ПоказательПлана1Оборот) ИНАЧЕ 100 КОНЕЦ КАК Показатель1РазницаПроцентОборот, //ПОКАЗАТЕЛЬ
ВЫБОР КОГДА СУММА(ПоказательПлана2Оборот)<>0 ТОГДА (СУММА(ПоказательПлана2Оборот) - СУММА(ПоказательФакта2Оборот)) * 100 / СУММА(ПоказательПлана2Оборот) ИНАЧЕ 100 КОНЕЦ КАК Показатель2РазницаПроцентОборот, //ПОКАЗАТЕЛЬ
ВЫБОР КОГДА СУММА(ПоказательПлана3Оборот)<>0 ТОГДА (СУММА(ПоказательПлана3Оборот) - СУММА(ПоказательФакта3Оборот)) * 100 / СУММА(ПоказательПлана3Оборот) ИНАЧЕ 100 КОНЕЦ КАК Показатель3РазницаПроцентОборот //ПОКАЗАТЕЛЬ

//ИТОГИСВОЙСТВА

ПО ОБЩИЕ ,
	ПодразделениеКомпании КАК Подразделение,
	ВидПлана КАК ВидПланаКомпании,
	ВидАналитикиПланирования1 ИЕРАРХИЯ  КАК ВидАналитикиПланирования1,
	ВидАналитикиПланирования2 ИЕРАРХИЯ  КАК ВидАналитикиПланирования2
АВТОУПОРЯДОЧИВАНИЕ