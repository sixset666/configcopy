#Область НачальныеОстатки
ВЫБРАТЬ
	Вложенный.СкладКомпании КАК СкладКомпании,
	Вложенный.СкладКомпании.Организация КАК Организация,
	Вложенный.СкладКомпании.Подразделение КАК Подразделение,
	Вложенный.Номенклатура КАК Номенклатура,
	Вложенный.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	СУММА(Вложенный.СкладКомпанииОстаток) КАК КоличествоСкладКомпанииНачальныйОстаток,
	СУММА(Вложенный.ОрдерныйСкладОстаток) КАК КоличествоОрдерныйСкладНачальныйОстаток	
	
	ИЗ
(ВЫБРАТЬ
	ОстаткиТоваровОрдерныйСкладОстатки.Номенклатура ,
	ОстаткиТоваровОрдерныйСкладОстатки.ХарактеристикаНоменклатуры ,
	ОстаткиТоваровОрдерныйСкладОстатки.СкладКомпании,
	ОстаткиТоваровОрдерныйСкладОстатки.КоличествоОстаток КАК ОрдерныйСкладОстаток,
	0 КАК СкладКомпанииОстаток
 ИЗ
	РегистрНакопления.ОстаткиТоваровОрдерныйСклад.Остатки(&ДатаНач,{
	СкладКомпании.ВидСклада.* КАК ВидСклада,
	СкладКомпании.* КАК СкладКомпании,
	СкладКомпании.Организация.* КАК Организация,
	СкладКомпании.Подразделение.* КАК Подразделение,
	Номенклатура.* КАК Номенклатура,
	ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры}) КАК ОстаткиТоваровОрдерныйСкладОстатки

 ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ОстаткиТоваровКомпанииОстатки.Номенклатура,
	ОстаткиТоваровКомпанииОстатки.ХарактеристикаНоменклатуры,
	ОстаткиТоваровКомпанииОстатки.СкладКомпании,
	0,
	ОстаткиТоваровКомпанииОстатки.КоличествоОстаток
ИЗ
	РегистрНакопления.ОстаткиТоваровКомпании.Остатки(&ДатаНач, {
	СкладКомпании.ВидСклада.* КАК ВидСклада,
	СкладКомпании.* КАК СкладКомпании,
	СкладКомпании.Организация.* КАК Организация,
	СкладКомпании.Подразделение.* КАК Подразделение,
	Номенклатура.* КАК Номенклатура,
	ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры}) КАК ОстаткиТоваровКомпанииОстатки) КАК Вложенный
СГРУППИРОВАТЬ ПО
	Вложенный.СкладКомпании,
	Вложенный.Номенклатура,
	Вложенный.ХарактеристикаНоменклатуры
ИМЕЮЩИЕ
&ВыводитьТолькоНеНулевуюРазницу И СУММА(Вложенный.ОрдерныйСкладОстаток - Вложенный.СкладКомпанииОстаток)<>0
     ИЛИ (НЕ &ВыводитьТолькоНеНулевуюРазницу)   
#КонецОбласти

#Область ОборотыПриход
ВЫБРАТЬ
	Обороты.СкладКомпании КАК СкладКомпании,
	Обороты.СкладКомпании.Организация КАК Организация,
	Обороты.СкладКомпании.Подразделение КАК Подразделение,
	Обороты.Номенклатура КАК Номенклатура,
	Обороты.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	Обороты.Регистратор КАК ПериодРегистратор,
	Обороты.Период КАК Период,
	Обороты.КоличествоСклад КАК КоличествоСкладКомпанииПриход,
	Обороты.КоличествоОрдерный КАК КоличествоОрдерныйСкладПриход		
ИЗ
(ВЫБРАТЬ
	Обороты.Номенклатура,
	Обороты.ХарактеристикаНоменклатуры,
	Обороты.СкладКомпании,
	Обороты.Регистратор,
	Обороты.Период КАК Период,
	0 КАК КоличествоСклад,
	Обороты.Количество КАК КоличествоОрдерный
ИЗ РегистрНакопления.ОстаткиТоваровОрдерныйСклад КАК Обороты
	ГДЕ Обороты.Период >= &ДатаНач И Обороты.Период <= &ДатаКон
	И Обороты.ВидДвижения = &ВидДвиженияПриход
{ГДЕ
	Обороты.СкладКомпании.* КАК СкладКомпании,
	Обороты.СкладКомпании.Организация.* КАК Организация,
	Обороты.СкладКомпании.ВидСклада.* КАК ВидСклада,
	Обороты.СкладКомпании.Подразделение.* КАК Подразделение,
	Обороты.Номенклатура.* КАК Номенклатура,
	Обороты.ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры,
	Обороты.Регистратор.* КАК ПериодРегистратор}

ОБЪЕДИНИТЬ ВСЕ	

ВЫБРАТЬ
	Обороты.Номенклатура,
	Обороты.ХарактеристикаНоменклатуры,
	Обороты.СкладКомпании,
	Обороты.Регистратор,
	Обороты.Период КАК Период,
	Обороты.Количество КАК КоличествоСклад,
	0  КАК КоличествоОрдерный
 ИЗ
	РегистрНакопления.ОстаткиТоваровКомпании КАК Обороты
	ГДЕ Обороты.Период >= &ДатаНач И Обороты.Период <= &ДатаКон
	И Обороты.ВидДвижения = &ВидДвиженияПриход
{ГДЕ
	Обороты.СкладКомпании.* КАК СкладКомпании,
	Обороты.СкладКомпании.Организация.* КАК Организация,
	Обороты.СкладКомпании.ВидСклада.* КАК ВидСклада,
	Обороты.СкладКомпании.Подразделение.* КАК Подразделение,
	Обороты.Номенклатура.* КАК Номенклатура,
	Обороты.ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры,
	Обороты.Регистратор.* КАК ПериодРегистратор}
 ) КАК Обороты
#КонецОбласти

#Область ОборотыРасход
ВЫБРАТЬ
	Обороты.СкладКомпании КАК СкладКомпании,
	Обороты.СкладКомпании.Организация КАК Организация,
	Обороты.СкладКомпании.Подразделение КАК Подразделение,
	Обороты.Номенклатура КАК Номенклатура,
	Обороты.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	Обороты.Регистратор КАК ПериодРегистратор,
	Обороты.Период КАК Период,
	Обороты.КоличествоСклад КАК КоличествоСкладКомпанииРасход,
	Обороты.КоличествоОрдерный КАК КоличествоОрдерныйСкладРасход		
ИЗ
(ВЫБРАТЬ
	Обороты.Номенклатура,
	Обороты.ХарактеристикаНоменклатуры,
	Обороты.СкладКомпании КАК СкладКомпании,
	Обороты.Регистратор,
	Обороты.Период КАК Период,
	0 КАК КоличествоСклад,
	Обороты.Количество КАК КоличествоОрдерный
ИЗ РегистрНакопления.ОстаткиТоваровОрдерныйСклад КАК Обороты
ГДЕ Обороты.Период >= &ДатаНач И Обороты.Период <= &ДатаКон
	И Обороты.ВидДвижения = &ВидДвиженияРасход
{ГДЕ
	Обороты.СкладКомпании.* КАК СкладКомпании,
	Обороты.СкладКомпании.Организация.* КАК Организация,
	Обороты.СкладКомпании.ВидСклада.* КАК ВидСклада,
	Обороты.СкладКомпании.Подразделение.* КАК Подразделение,
	Обороты.Номенклатура.* КАК Номенклатура,
	Обороты.ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры,
	Обороты.Регистратор.* КАК ПериодРегистратор}

ОБЪЕДИНИТЬ ВСЕ	

ВЫБРАТЬ
	Обороты.Номенклатура,
	Обороты.ХарактеристикаНоменклатуры,
	Обороты.СкладКомпании,
	Обороты.Регистратор,
	Обороты.Период КАК Период,
	Обороты.Количество КАК КоличествоСклад,
	0 КАК КоличествоОрдерный
 ИЗ
	РегистрНакопления.ОстаткиТоваровКомпании КАК Обороты
ГДЕ Обороты.Период >= &ДатаНач И Обороты.Период <= &ДатаКон
	И Обороты.ВидДвижения = &ВидДвиженияРасход
{ГДЕ
	Обороты.СкладКомпании.* КАК СкладКомпании,
	Обороты.СкладКомпании.Организация.* КАК Организация,
	Обороты.СкладКомпании.ВидСклада.* КАК ВидСклада,
	Обороты.СкладКомпании.Подразделение.* КАК Подразделение,
	Обороты.Номенклатура.* КАК Номенклатура,
	Обороты.ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры,
	Обороты.Регистратор.* КАК ПериодРегистратор}
 ) КАК Обороты
#КонецОбласти
  
	
#Область КонечныеОстатки
ВЫБРАТЬ
	Вложенный.СкладКомпании КАК СкладКомпании,
	Вложенный.СкладКомпании.Организация КАК Организация,
	Вложенный.СкладКомпании.Подразделение КАК Подразделение,
	Вложенный.Номенклатура КАК Номенклатура,
	Вложенный.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	СУММА(Вложенный.СкладКомпанииОстаток) КАК КоличествоСкладКомпанииКонечныйОстаток,
	СУММА(Вложенный.ОрдерныйСкладОстаток) КАК КоличествоОрдерныйСкладКонечныйОстаток	
ИЗ
(ВЫБРАТЬ
	ОстаткиТоваровОрдерныйСкладОстатки.Номенклатура,
	ОстаткиТоваровОрдерныйСкладОстатки.ХарактеристикаНоменклатуры,
	ОстаткиТоваровОрдерныйСкладОстатки.СкладКомпании,
	ОстаткиТоваровОрдерныйСкладОстатки.КоличествоОстаток КАК ОрдерныйСкладОстаток,
	0 КАК СкладКомпанииОстаток
 ИЗ
	РегистрНакопления.ОстаткиТоваровОрдерныйСклад.Остатки(&ДатаКонДляОстатка,{
	СкладКомпании.ВидСклада.* КАК ВидСклада,
	СкладКомпании.* КАК СкладКомпании,
	СкладКомпании.Организация.* КАК Организация,
	СкладКомпании.Подразделение.* КАК Подразделение,
	Номенклатура.* КАК Номенклатура,
	ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры}) КАК ОстаткиТоваровОрдерныйСкладОстатки

 ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ОстаткиТоваровКомпанииОстатки.Номенклатура,
	ОстаткиТоваровКомпанииОстатки.ХарактеристикаНоменклатуры,
	ОстаткиТоваровКомпанииОстатки.СкладКомпании,
	0,
	ОстаткиТоваровКомпанииОстатки.КоличествоОстаток
ИЗ
	РегистрНакопления.ОстаткиТоваровКомпании.Остатки(&ДатаКонДляОстатка, {
	СкладКомпании.ВидСклада.* КАК ВидСклада,
	СкладКомпании.* КАК СкладКомпании,
	СкладКомпании.Организация.* КАК Организация,
	СкладКомпании.Подразделение.* КАК Подразделение,
	Номенклатура.* КАК Номенклатура,
	ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры}) КАК ОстаткиТоваровКомпанииОстатки) КАК Вложенный
СГРУППИРОВАТЬ ПО
	Вложенный.СкладКомпании,
	Вложенный.Номенклатура,
	Вложенный.ХарактеристикаНоменклатуры
ИМЕЮЩИЕ
&ВыводитьТолькоНеНулевуюРазницу И СУММА(Вложенный.ОрдерныйСкладОстаток - Вложенный.СкладКомпанииОстаток)<>0
     ИЛИ (НЕ &ВыводитьТолькоНеНулевуюРазницу)
#КонецОбласти

