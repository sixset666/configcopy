ВЫБРАТЬ РАЗРЕШЕННЫЕ
	СУММА(ОбъединенныйЗапрос.СуммаРегПланДоход)  КАК ПланСуммаРегДоход,
	СУММА(ОбъединенныйЗапрос.СуммаРегПланРасход) КАК ПланСуммаРегРасход,
	СУММА(ОбъединенныйЗапрос.СуммаУпрПланДоход)  КАК ПланСуммаУпрДоход,
	СУММА(ОбъединенныйЗапрос.СуммаУпрПланРасход) КАК ПланСуммаУпрРасход,
	
	СУММА(ОбъединенныйЗапрос.СуммаРегФактДоход)  КАК ФактСуммаРегДоход,
	СУММА(ОбъединенныйЗапрос.СуммаРегФактРасход) КАК ФактСуммаРегРасход,
	СУММА(ОбъединенныйЗапрос.СуммаУпрФактДоход)  КАК ФактСуммаУпрДоход,
	СУММА(ОбъединенныйЗапрос.СуммаУпрФактРасход) КАК ФактСуммаУпрРасход,
	
	СУММА(ОбъединенныйЗапрос.СуммаРегФактДоход - ОбъединенныйЗапрос.СуммаРегПланДоход) КАК ОтклонениеСуммаРегДоход,
	СУММА(ОбъединенныйЗапрос.СуммаРегФактРасход - ОбъединенныйЗапрос.СуммаРегПланРасход) КАК ОтклонениеСуммаРегРасход,
	СУММА(ОбъединенныйЗапрос.СуммаУпрФактДоход - ОбъединенныйЗапрос.СуммаУпрПланДоход) КАК ОтклонениеСуммаУпрДоход,
	СУММА(ОбъединенныйЗапрос.СуммаУпрФактРасход - ОбъединенныйЗапрос.СуммаУпрПланРасход) КАК ОтклонениеСуммаУпрРасход
	//СВОЙСТВА

{ВЫБРАТЬ 
#Область ИзмеренияПостроителяДляСвойств
	ОбъединенныйЗапрос.ПодразделениеКомпании.Организация.* КАК Организация,
	ОбъединенныйЗапрос.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	ОбъединенныйЗапрос.СтатьяДДС.* КАК СтатьяДДС,
#КонецОбласти	
	ОбъединенныйЗапрос.Период КАК Период
	//СВОЙСТВА}
	
ИЗ 
	(
	 ВЫБРАТЬ
	  БюджетДДС.ПодразделениеКомпании КАК ПодразделениеКомпании,
	  БюджетДДС.СтатьяДДС КАК СтатьяДДС,
	  БюджетДДС.Период КАК Период,
	  
	  ВЫБОР
	  	КОГДА НЕ БюджетДДС.СтатьяДДС.ВидДвижения = ЗНАЧЕНИЕ(Перечисление.ВидыДвижений.Расход) И БюджетДДС.СуммаРегОборот>=0 ТОГДА
	  		БюджетДДС.СуммаРегОборот
	  	КОГДА БюджетДДС.СтатьяДДС.ВидДвижения = ЗНАЧЕНИЕ(Перечисление.ВидыДвижений.Расход) И БюджетДДС.СуммаРегОборот<0 ТОГДА
	  		БюджетДДС.СуммаРегОборот
	  	ИНАЧЕ 0
	  КОНЕЦ КАК СуммаРегПланДоход,
	  ВЫБОР
	  	КОГДА НЕ БюджетДДС.СтатьяДДС.ВидДвижения = ЗНАЧЕНИЕ(Перечисление.ВидыДвижений.Приход) И БюджетДДС.СуммаРегОборот>=0 ТОГДА
	  		БюджетДДС.СуммаРегОборот
	  	КОГДА БюджетДДС.СтатьяДДС.ВидДвижения = ЗНАЧЕНИЕ(Перечисление.ВидыДвижений.Приход) И БюджетДДС.СуммаРегОборот<0 ТОГДА
	  		БюджетДДС.СуммаРегОборот
	  	ИНАЧЕ 0
	  КОНЕЦ КАК СуммаРегПланРасход,
	  ВЫБОР
	  	КОГДА НЕ БюджетДДС.СтатьяДДС.ВидДвижения = ЗНАЧЕНИЕ(Перечисление.ВидыДвижений.Расход) И БюджетДДС.СуммаУпрОборот>=0 ТОГДА
	  		БюджетДДС.СуммаУпрОборот
	  	КОГДА БюджетДДС.СтатьяДДС.ВидДвижения = ЗНАЧЕНИЕ(Перечисление.ВидыДвижений.Расход) И БюджетДДС.СуммаУпрОборот<0 ТОГДА
	  		БюджетДДС.СуммаУпрОборот
	  	ИНАЧЕ 0
	  КОНЕЦ КАК СуммаУпрПланДоход,
	  ВЫБОР
	  	КОГДА НЕ БюджетДДС.СтатьяДДС.ВидДвижения = ЗНАЧЕНИЕ(Перечисление.ВидыДвижений.Приход) И БюджетДДС.СуммаУпрОборот>=0 ТОГДА
	  		БюджетДДС.СуммаУпрОборот
	  	КОГДА БюджетДДС.СтатьяДДС.ВидДвижения = ЗНАЧЕНИЕ(Перечисление.ВидыДвижений.Приход) И БюджетДДС.СуммаУпрОборот<0 ТОГДА
	  		БюджетДДС.СуммаУпрОборот
	  	ИНАЧЕ 0
	  КОНЕЦ КАК СуммаУпрПланРасход,
	  0 КАК СуммаРегФактДоход,
	  0 КАК СуммаРегФактРасход,
	  0 КАК СуммаУпрФактДоход,
	  0 КАК СуммаУпрФактРасход
	
	 ИЗ
	 РегистрНакопления.БюджетДДС.Обороты(&ДатаНач, &ДатаКон, Месяц, СценарийПланирования = &СценарийПланирования{
		ПодразделениеКомпании.Организация.* КАК Организация, 
		ПодразделениеКомпании.* КАК ПодразделениеКомпании, 
		СтатьяДДС.* КАК СтатьяДДС
		}) КАК БюджетДДС
	   
		
	 ОБЪЕДИНИТЬ ВСЕ
	 
	 ВЫБРАТЬ
	  	ДенежныеСредстваКомпании.Регистратор.ПодразделениеКомпании,
	  	ДенежныеСредстваКомпании.СтатьяДДС,
	    НАЧАЛОПЕРИОДА(ДенежныеСредстваКомпании.Период, Месяц),
	 	0,
	 	0,
	 	0,
	 	0,
	 	ВЫБОР КОГДА (ДенежныеСредстваКомпании.ВидДвижения=ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) И ДенежныеСредстваКомпании.Сумма>=0) ИЛИ (ДенежныеСредстваКомпании.ВидДвижения=ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) И ДенежныеСредстваКомпании.Сумма<=0) ТОГДА ДенежныеСредстваКомпании.Сумма ИНАЧЕ 0 КОНЕЦ,
	 	ВЫБОР КОГДА (ДенежныеСредстваКомпании.ВидДвижения=ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) И ДенежныеСредстваКомпании.Сумма<=0) ИЛИ (ДенежныеСредстваКомпании.ВидДвижения=ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) И ДенежныеСредстваКомпании.Сумма>=0) ТОГДА ДенежныеСредстваКомпании.Сумма ИНАЧЕ 0 КОНЕЦ,
	 	ВЫБОР КОГДА (ДенежныеСредстваКомпании.ВидДвижения=ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) И ДенежныеСредстваКомпании.СуммаУпр>=0) ИЛИ (ДенежныеСредстваКомпании.ВидДвижения=ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) И ДенежныеСредстваКомпании.СуммаУпр<=0) ТОГДА ДенежныеСредстваКомпании.СуммаУпр ИНАЧЕ 0 КОНЕЦ,
	 	ВЫБОР КОГДА (ДенежныеСредстваКомпании.ВидДвижения=ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) И ДенежныеСредстваКомпании.СуммаУпр<=0) ИЛИ (ДенежныеСредстваКомпании.ВидДвижения=ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) И ДенежныеСредстваКомпании.СуммаУпр>=0) ТОГДА ДенежныеСредстваКомпании.СуммаУпр ИНАЧЕ 0 КОНЕЦ
	 	
	 ИЗ
	 РегистрНакопления.ДенежныеСредстваКомпании КАК ДенежныеСредстваКомпании
	 
	 ГДЕ
	 	ДенежныеСредстваКомпании.Период МЕЖДУ &ДатаНач И &ДатаКон
	 	И ДенежныеСредстваКомпании.Валюта = &ВалютаРегл
	 	
	 //ГДЕ
	 //	ОстаткиАвтомобилей.КоличествоПриход > 0
	 {ГДЕ
	    Регистратор.ПодразделениеКомпании.Организация.* КАК Организация, 
	 	Регистратор.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	  	СтатьяДДС.* КАК СтатьяДДС}
	) КАК ОбъединенныйЗапрос
	//СОЕДИНЕНИЯ 
	
СГРУППИРОВАТЬ ПО
	ОбъединенныйЗапрос.ПодразделениеКомпании,
	ОбъединенныйЗапрос.СтатьяДДС,
	ОбъединенныйЗапрос.Период
	//СГРУППИРОВАТЬПО
	
 ИМЕЮЩИЕ
	&ВыводитьВсеЗаписи ИЛИ (СУММА(ОбъединенныйЗапрос.СуммаУпрПланДоход)-СУММА(ОбъединенныйЗапрос.СуммаУпрПланРасход))<>0
	
{ГДЕ 
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	СтатьяДДС.* КАК СтатьяДДС
	 //СВОЙСТВА}
	
{УПОРЯДОЧИТЬ ПО 
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	СтатьяДДС.* КАК СтатьяДДС,
	Период КАК Период
	 //СВОЙСТВА}
	
{ИТОГИ ПО 
	ПодразделениеКомпании.Организация.* КАК Организация,
	ПодразделениеКомпании.* КАК ПодразделениеКомпании,
	СтатьяДДС.* КАК СтатьяДДС,
	Период КАК Период
	//СВОЙСТВА}
	
ИТОГИ  
	СУММА(ПланСуммаРегДоход),
	СУММА(ПланСуммаРегРасход),
	СУММА(ПланСуммаУпрДоход),
	СУММА(ПланСуммаУпрРасход),
	
	СУММА(ФактСуммаРегДоход),
	СУММА(ФактСуммаРегРасход),
	СУММА(ФактСуммаУпрДоход),
	СУММА(ФактСуммаУпрРасход),
	
	СУММА(ОтклонениеСуммаРегДоход),
	СУММА(ОтклонениеСуммаРегРасход),
	СУММА(ОтклонениеСуммаУпрДоход),
	СУММА(ОтклонениеСуммаУпрРасход)
	//ИТОГИСВОЙСТВА
	
ПО ОБЩИЕ
				
АВТОУПОРЯДОЧИВАНИЕ
