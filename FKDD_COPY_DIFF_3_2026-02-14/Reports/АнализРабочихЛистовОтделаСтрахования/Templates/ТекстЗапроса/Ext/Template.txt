ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ВЫРАЗИТЬ(ЖурналСостояний.Объект КАК Документ.РабочийЛистОтделаСтрахования)	КАК РабочийЛист,
	ВЫРАЗИТЬ(ЖурналСостояний.Состояние КАК Справочник.СтатусыРабочегоЛиста)		КАК Статус

ПОМЕСТИТЬ ТаблицаРабочихЛистов
ИЗ
	РегистрСведений.ЖурналСостояний.СрезПоследних(&ДатаКон, ) КАК ЖурналСостояний
ГДЕ
	ЖурналСостояний.Объект ССЫЛКА Документ.РабочийЛистОтделаСтрахования
	И ЖурналСостояний.Состояние ССЫЛКА Справочник.СтатусыРабочегоЛиста
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	РабочиеЛисты.РабочийЛист								КАК РабочийЛист,
	РабочиеЛисты.Статус										КАК Статус,
	Страхование.Страховщик									КАК СтраховаяКомпания,
	Страхование.ОбъектСтрахования							КАК ОбъектСтрахования,
	РабочиеЛисты.РабочийЛист.МенеджерОтделаСтрахования		КАК МенеджерСтраховогоОтдела,
	Страхование.ВидСтрахования								КАК ВидСтрахования,
	Страхование.ПрограммаСтрахования						КАК ПрограммаСтрахования,
	РабочиеЛисты.РабочийЛист.ПричинаОтказа					КАК ПричинаОтказа,
	Страхование.ЭтоПролонгация								КАК ЭтоПролонгация,
	РабочиеЛисты.РабочийЛист.ПодразделениеКомпании			КАК ПодразделениеКомпании,
	РабочиеЛисты.РабочийЛист.ВидОплаты						КАК ВидОплаты

ПОМЕСТИТЬ ТаблицаСостояний

ИЗ
	Документ.РабочийЛистОтделаСтрахования.ВариантыСтрахования КАК Страхование
		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаРабочихЛистов КАК РабочиеЛисты
		ПО РабочиеЛисты.РабочийЛист = Страхование.Ссылка
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ТаблицаКоличества.РабочийЛист		КАК РабочийЛист,
	Количество(ТаблицаКоличества.РабочийЛист) КАК КоличествоВсего

ПОМЕСТИТЬ ТаблицаКоличества

ИЗ
	ТаблицаСостояний КАК ТаблицаКоличества
	
СГРУППИРОВАТЬ ПО
	ТаблицаКоличества.РабочийЛист	
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ	
	#Область ИзмеренияПостроителяДляСвойств	
	ТаблицаСостояний.РабочийЛист				КАК РабочийЛистОтделаСтрахования,
	ТаблицаСостояний.ПодразделениеКомпании		КАК ПодразделениеКомпании,
	ТаблицаСостояний.СтраховаяКомпания			КАК СтраховаяКомпания,
	ТаблицаСостояний.ОбъектСтрахования			КАК ОбъектСтрахования,
	ТаблицаСостояний.МенеджерСтраховогоОтдела	КАК МенеджерСтраховогоОтдела,	
	ТаблицаСостояний.ПрограммаСтрахования		КАК ПрограммаСтрахования,
	ТаблицаСостояний.ПричинаОтказа				КАК ПричинаОтказа,
	#КонецОбласти	
	ТаблицаСостояний.Статус						КАК Статус,
	ТаблицаСостояний.ВидОплаты					КАК ВидОплаты,
	ТаблицаСостояний.ВидСтрахования				КАК ВидСтрахования,
	ТаблицаСостояний.ЭтоПролонгация				КАК ЭтоПролонгация,
	ТаблицаКоличества.КоличествоВсего			КАК КоличествоВсего,
	ТаблицаКоличества.КоличествоВсего			КАК КоличествоРабочихЛистов,
	ТаблицаПрограмм.Количество					КАК КоличествоВариантовСтрахования	
	//СВОЙСТВА
	
{ВЫБРАТЬ
    РабочийЛистОтделаСтрахования.*				КАК РабочийЛистОтделаСтрахования,
	ПодразделениеКомпании.*						КАК ПодразделениеКомпании,	
	СтраховаяКомпания.*							КАК СтраховаяКомпания,
	ОбъектСтрахования.*							КАК ОбъектСтрахования,
	МенеджерСтраховогоОтдела.*					КАК МенеджерСтраховогоОтдела,	
	ПрограммаСтрахования.*						КАК ПрограммаСтрахования,
	ПричинаОтказа.*								КАК ПричинаОтказа,	
	Статус.*									КАК Статус,
	ВидОплаты									КАК ВидОплаты,
	ВидСтрахования								КАК ВидСтрахования,
	ЭтоПролонгация								КАК ЭтоПролонгация
	//СВОЙСТВА
}	
	
ИЗ
	ТаблицаСостояний КАК ТаблицаСостояний
	ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаКоличества КАК ТаблицаКоличества
		ПО ТаблицаСостояний.РабочийЛист=ТаблицаКоличества.РабочийЛист 
	ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
						ТаблицаПрограммСтроки.ПрограммаСтрахования				КАК ПрограммаСтрахования,
						КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ТаблицаПрограммСтроки.ПрограммаСтрахования)	КАК Количество						
					   ИЗ
					   	ТаблицаСостояний КАК ТаблицаПрограммСтроки
					  СГРУППИРОВАТЬ ПО
					  	ТаблицаПрограммСтроки.ПрограммаСтрахования) КАК ТаблицаПрограмм
		ПО ТаблицаСостояний.ПрограммаСтрахования = ТаблицаПрограмм.ПрограммаСтрахования		
	//СОЕДИНЕНИЯ

{ГДЕ
	ТаблицаСостояний.РабочийЛист.*							КАК РабочийЛистОтделаСтрахования,
	ТаблицаСостояний.ПодразделениеКомпании.*				КАК ПодразделениеКомпании,
	ТаблицаСостояний.СтраховаяКомпания.*					КАК СтраховаяКомпания,
	ТаблицаСостояний.ОбъектСтрахования.*					КАК ОбъектСтрахования,
	ТаблицаСостояний.МенеджерСтраховогоОтдела.*				КАК МенеджерСтраховогоОтдела,	
	ТаблицаСостояний.ПрограммаСтрахования.*					КАК ПрограммаСтрахования,
	ТаблицаСостояний.ПричинаОтказа.*						КАК ПричинаОтказа,	
	ТаблицаСостояний.Статус.*								КАК Статус,
	ТаблицаСостояний.ВидОплаты								КАК ВидОплаты,
	ТаблицаСостояний.ВидСтрахования							КАК ВидСтрахования,
	ТаблицаСостояний.ЭтоПролонгация							КАК ЭтоПролонгация
	//СВОЙСТВА
}

{УПОРЯДОЧИТЬ ПО
	РабочийЛистОтделаСтрахования.*					КАК РабочийЛистОтделаСтрахования,
	ПодразделениеКомпании.*							КАК ПодразделениеКомпании,	
	СтраховаяКомпания.*								КАК СтраховаяКомпания,
	ОбъектСтрахования.*								КАК ОбъектСтрахования,
	МенеджерСтраховогоОтдела.*						КАК МенеджерСтраховогоОтдела,	
	ПрограммаСтрахования.*							КАК ПрограммаСтрахования,
	ПричинаОтказа.*									КАК ПричинаОтказа,	
	Статус.*										КАК Статус,
	ВидОплаты										КАК ВидОплаты,
	ВидСтрахования									КАК ВидСтрахования,
	ЭтоПролонгация									КАК ЭтоПролонгация
	//СВОЙСТВА
}
		
ИТОГИ	
	СУММА(КоличествоРабочихЛистов) КАК КоличествоРабочихЛистов	// ИТОГИ_ДЛЯ_ЗАМЕНЫ
	
	//ИТОГИСВОЙСТВА
ПО
	ОБЩИЕ,
	Статус,
	ПодразделениеКомпании,	
	МенеджерСтраховогоОтдела,
	ПричинаОтказа,
	ВидОплаты,
	СтраховаяКомпания,		
	ПрограммаСтрахования,		
	ВидСтрахования,	
	ЭтоПролонгация,
	ОбъектСтрахования,
	РабочийЛистОтделаСтрахования	

{ИТОГИ ПО
	Статус.*										КАК Статус,
	ПодразделениеКомпании.*							КАК ПодразделениеКомпании,	
	МенеджерСтраховогоОтдела.*						КАК МенеджерСтраховогоОтдела,
	СтраховаяКомпания.*								КАК СтраховаяКомпания,		
	ОбъектСтрахования.*								КАК ОбъектСтрахования,
	ПрограммаСтрахования.*							КАК ПрограммаСтрахования,
	ПричинаОтказа.*									КАК ПричинаОтказа,		
	ВидОплаты										КАК ВидОплаты,
	ВидСтрахования									КАК ВидСтрахования,
	ЭтоПролонгация									КАК ЭтоПролонгация,
	РабочийЛистОтделаСтрахования.*					КАК РабочийЛистОтделаСтрахования
	//СВОЙСТВА
}

;
////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ТаблицаРабочихЛистов
;
////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ТаблицаСостояний
