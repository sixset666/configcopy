<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html xmlns:o=""><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"></meta><link rel="stylesheet" type="text/css" href="v8help://service_book/service_style"></link><meta name="GENERATOR" content="MSHTML 8.00.7601.17514"></meta></head><body><link rel="stylesheet" type="text/css" href="v8help://service_book/service_style"></link><meta name="GENERATOR" content="MSHTML 6.00.3790.186"></meta><h1><font color="#000080">Обработка "Загрузка данных из табличного документа".</font></h1>
<h3>Назначение</h3>
<p class="Usual">Обработка предназначена для для загрузки данных в справочники, регистры сведений и табличные части различных объектов из табличного документа. Пользователь может использовать алгоритм заполнения по умолчанию или настроить его самостоятельно для каждого из реквизитов объекта. ВАЖНО! Настраивать алгоритм заполнения рекомендуется «опытным» пользователям, т.к. следует учесть, что при заполнении не выполняется контроль целостности данных и авто-заполнение связных реквизитов, (например: при выборе номенклатуры не устанавливается ставка НДС).</p>
<h3>Формы</h3>
<ul><li><strong>Форма</strong>. Содержит две закладки. На первой (закладка «Настройка») производится настройка таблицы загружаемых реквизитов, на второй (закладка «Табличный документ») выполняется заполнение табличного документа представлениями загружаемых данных. </li></ul><h3>Способ вызова</h3>
<ul><li>
<p class="Usual">Вызывается из формы элемента документов</p>
</li><li>
<p class="Usual">Вызывается из меню <font color="#800000">"Обработки--&gt; Загрузка данных из табличного документа</font>".</p></li></ul><h3></h3>
<p class="Usual">Дополнительная информация </p>
<ul><h3></h3>
<p class="Usual">Обработка поддерживает 3 режима загрузки данных:</p>
<ul><li><strong>в справочник</strong>. 
</li><li><strong>в табличную часть</strong>. 
</li><li><strong>в регистр сведения</strong>. </li></ul><h3></h3>
<p class="Usual">Элементы управления режима загрузки:</p>
<ul><li><strong>Поле выбора «Вид справочника»</strong>. Доступен только для режима загрузки в справочник. 
</li><li><strong>Поле выбора «Способ загрузки»</strong>. Используется для режима загрузки в справочник. Способ загрузки, при котором будут добавляться новые элементы или редактироваться старые:<br>- Только новые. Осуществляется загрузка элементов, не содержавшихся ранее в справочнике.<br>- Только старые. Осуществляется перезапись элементов, содержавшихся ранее в справочнике.<br>- Все. Осуществляется загрузка новых элементов и перезапись старых. 
</li><li><strong>Флажок «Замещать существующие записи»</strong>. Используется для режима загрузки в регистр сведений. В случае, когда флажок не взведен, то записи, соответствующие ключевым измерениям не замещаются, а изменяются, иначе - записи добавляются. 
</li><li><strong>Флажок «Ручная нумерация колонок табличного документа»</strong>. Используется для ручной нумерации колонок табличного документа, в случае, когда состав колонок табличного документа отличается от отмеченных загружаемых реквизитов. 
</li><li><strong>Поле ввода «Первая строка данных табличного документа»</strong>. Определяет, с какой строки табличного документа загружать элементы. </li></ul><h3></h3>
<p class="Usual">Таблица загружаемых реквизитов имеет следующие колонки:</p>
<ul><li><strong>Флажок «Пометка»</strong>. Тип: «Булево», изменяется пользователем, используется для отметки, какие реквизиты следует загружать; (для режима загрузки в регистр сведений обязательна отметка всех измерений регистра и период) 
</li><li><strong>Поле ввода «Представление реквизита»</strong>. Тип «Строка», не изменяется пользователем; 
</li><li><strong>Поле ввода «Имя реквизита»</strong>. Тип «Строка», не изменяется пользователем; 
</li><li><strong>Флажок «Может быть полем поиска»</strong>. Тип: «Булево», не изменяется пользователем (используется только в режиме загрузки в справочник для реквизитов код, наименование, индексированных реквизитов типа «Строка») 
</li><li><strong>Флажок «Поле поиска»</strong>. Тип: «Булево», изменяется пользователем (только для реквизитов, которые могут быть полем поиска) 
</li><li><strong>Поле ввода «Доступное описание типов»</strong>. Тип «Описание типов», не изменяется пользователем 
</li><li><strong>Поле ввода «Описание типов»</strong>. Тип «Описание типов», изменяется пользователем, изменяется пользователем, но имеет ограничение типов из графы «Ограничение типов» 
</li><li><strong>Поле выбора «Режим загрузки»</strong>. (Искать/Вычислять/Устанавливать) 
</li><li><strong>Поле ввода «№ Колонки табличного»</strong>. Для режима «Ручная нумерация колонок табличного документа» 
</li><li><strong>Поле ввода «Значение по умолчанию»</strong>. Тип задается в поле «Описание типов» 
</li><li><strong>Поле выбора «Искать по» (имя представления)</strong>. Используется для поиска значения реквизита ссылочного типа по представлению в выбранном виде (например: по коду, наименованию, артиклю) 
</li><li><strong>Поле выбора «Связь по владельцу»</strong>. Выбирается пользователем для реквизита ссылочного типа, имеющего владельца, содержит указание на колонку связи по владельцу в составе загружаемых реквизитов или на непосредственного владельца. 
</li><li><strong>Поле выбора «Связь по типу»</strong>. Выбирается пользователем для реквизитов типа «План видов характеристик», содержит указание на колонку связи по типу в составе загружаемых реквизитов или на ссылку элемента связи по типу (в основном типа «План счетов ссылка»). 
</li><li><strong>Поле ввода «Элемент связи по типу»</strong>. Изменяется пользователем для реквизитов типа «План видов характеристик», содержит номер элемента связи по типу (номер субконто) 
</li><li><strong>Поле ввода «Выражение» для режима «Вычислять» </strong></li></ul><h3>Порядок работы пользователя с обработкой:</h3>
<ul><p class="Usual">1. Выбрать режим загрузки ("Загрузка в справочник"/"Загрузка в табличную часть"/"Загрузка в регистр сведений").</p>
<p class="Usual">2. Выбрать вид справочника (для режима "Загрузка в справочник"), ссылку и табличную часть (для режима "Загрузка в табличную часть") или вид регистра сведений (для режима "Загрузка в регистр сведений").</p>
<p class="Usual">3. При необходимости выполнить настройку таблицы загружаемых реквизитов на закладке "Настройка", настройки так же можно восстановить(сохранить) из файла или профиля пользователя.</p>
<p class="Usual">4. Заполнить табличный документ. Заполнять можно как вручную, так и из внешних источников: Excel, табличный документ, текстовый документ, файл в формате dBase III (*.dbf), буфер обмена. Главное не нарушать шапку (первую строку табличного документа).</p>
<p class="Usual">5. Выполнить контроль заполнения (нажать на кнопку «Контроль заполнения»), при этом для каждой заполненной ячейки табличного документа заполняется расшифровка найденным значением. Если значение не однозначно, или не найдено, выдается сообщение об ошибке и заполняется комментарий в ячейке.</p>
<p class="Usual">6. Если обнаружены ошибки, определить значение реквизита вручную (в контекстном меню для ячейки табличного документа с комментарием выбрать пункт «Выбрать значение»).</p>
<p class="Usual">7. Выполнить загрузку (нажать на кнопку «Загрузить»), при этом данные из табличного документа будут выгружены в справочник или в табличную часть, в зависимости от выбранного режима загрузки. При загрузке также выполняется контроль заполнения, не зависимо от того, выполнялся ли он ранее. </p></ul></ul></body></html>