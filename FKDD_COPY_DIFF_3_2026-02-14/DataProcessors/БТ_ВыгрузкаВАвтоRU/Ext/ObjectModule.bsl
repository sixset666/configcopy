Процедура СформироватьФайлПоРемонтОбслуживаниеАвто() Экспорт
	
	СписокКолонокПропуска = Новый СписокЗначений;
	СписокКолонокПропуска.Добавить("Damages");
	
	СформироватьВыгрузкуЗН(2, СписокКолонокПропуска);
	
КонецПроцедуры

Процедура СформироватьФайлУстановкаДополнительногоОборудования() Экспорт
	
	СписокКолонокПропуска = Новый СписокЗначений;
	СписокКолонокПропуска.Добавить("type");
	СписокКолонокПропуска.Добавить("isplan");  
	СписокКолонокПропуска.Добавить("Damages");
	
	СформироватьВыгрузкуЗН(3,СписокКолонокПропуска);
	
КонецПроцедуры

Процедура СформироватьФайлДиагностика() Экспорт
	
	СписокКолонокПропуска = Новый СписокЗначений;
	СписокКолонокПропуска.Добавить("type");
	СписокКолонокПропуска.Добавить("isplan");
	
	СформироватьВыгрузкуЗН(12,СписокКолонокПропуска);
	
КонецПроцедуры


Процедура СформироватьВыгрузкуЗН(НомерВыгрузки,СписокКолонокПропуска = Неопределено)
	
	Если СписокКолонокПропуска = Неопределено Тогда
		
		СписокКолонокПропуска = Новый СписокЗначений;
		
	КонецЕсли;
	
	СписокКолонокПропуска.Добавить("Ссылка");
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("НазваниеНастройки","СписокТиповВидаРемонтаАвтотеки_"+НомерВыгрузки);
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	БТ_СписокКонстантныхЗначенийТаблицаДанных.Значение КАК Значение,
		|	БТ_СписокКонстантныхЗначенийТаблицаДанных.Значение1 КАК type,
		|	БТ_СписокКонстантныхЗначенийТаблицаДанных.Значение2 КАК isplan
		|ПОМЕСТИТЬ СписокВидовРемонта
		|ИЗ
		|	Справочник.БТ_СписокКонстантныхЗначений.ТаблицаДанных КАК БТ_СписокКонстантныхЗначенийТаблицаДанных
		|ГДЕ
		|	БТ_СписокКонстантныхЗначенийТаблицаДанных.Ссылка.Наименование = &НазваниеНастройки
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Автомобили.Автомобиль КАК Автомобиль,
		|	ВЫРАЗИТЬ(Автомобили.Значение КАК ЧИСЛО) КАК Пробег,
		|	Автомобили.Период КАК Период
		|ПОМЕСТИТЬ Пробег
		|ИЗ
		|	РегистрСведений.Автомобили КАК Автомобили
		|ГДЕ
		|	Автомобили.ВидЗначения = ЗНАЧЕНИЕ(Перечисление.ДополнительнаяИнформацияАвтомобилей.Пробег)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ЗаказНаряд.Номер КАК id,
		|	ГОД(ЗаказНаряд.Дата) КАК id_год,
		|	&et КАК et,
		|	ЗаказНаряд.Автомобиль.VIN КАК v,
		|	ЗаказНаряд.Дата КАК dt,
		|	""Краснодарский край"" КАК er,
		|	""Краснодар"" КАК ec,
		|	МАКСИМУМ(ЕСТЬNULL(СпПробег.Пробег, 0)) КАК m,
		|	ЕСТЬNULL(ЗаказНаряд.Автомобиль.Модель.Наименование, """") КАК cmodel,
		|	ЕСТЬNULL(ЗаказНаряд.Автомобиль.ВариантКомплектации.Наименование, """") КАК cdetails,
		|	ЕСТЬNULL(ГОД(ЗаказНаряд.Автомобиль.ГодВыпуска), 0) КАК y,
		|	ЕСТЬNULL(ЗаказНаряд.Автомобиль.ВариантКомплектации.ТипДвигателя.ОбъемДвигателя, 0) КАК cengs,
		|	ЕСТЬNULL(ЗаказНаряд.Автомобиль.Цвет.Наименование, """") КАК ccolor,
		|	ЕСТЬNULL(ЗаказНаряд.Автомобиль.ТипКПП.Наименование, """") КАК ctrans,
		|	ВЫБОР
		|		КОГДА ЗаказНаряд.Контрагент.ФормаСобственности = ЗНАЧЕНИЕ(Перечисление.ФормыСобственности.ЧастноеЛицо)
		|			ТОГДА 0
		|		ИНАЧЕ 1
		|	КОНЕЦ КАК clnttp,
		|	ЗаказНаряд.СуммаДокумента КАК amnt,
		|	СписокВидовРемонта.type КАК type,
		|	СписокВидовРемонта.isplan КАК isplan,
		|	ЗаказНаряд.Ссылка КАК Ссылка,
		|	ВЫРАЗИТЬ(ЗаказНаряд.Рекомендации КАК СТРОКА(500)) КАК Damages
		|ИЗ
		|	СписокВидовРемонта КАК СписокВидовРемонта
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ЗаказНаряд КАК ЗаказНаряд
		|			ЛЕВОЕ СОЕДИНЕНИЕ Пробег КАК СпПробег
		|			ПО ЗаказНаряд.Автомобиль = СпПробег.Автомобиль
		|				И ЗаказНаряд.Дата <= СпПробег.Период
		|		ПО СписокВидовРемонта.Значение = ЗаказНаряд.ВидРемонта
		|ГДЕ
		|	ЗаказНаряд.Проведен
		|	И ЗаказНаряд.Дата МЕЖДУ &НачПериода И &КонПериода
		|	И ЗаказНаряд.Состояние = &закрыт
		|
		|СГРУППИРОВАТЬ ПО
		|	ЗаказНаряд.Номер,
		|	ГОД(ЗаказНаряд.Дата),
		|	ЗаказНаряд.Автомобиль.VIN,
		|	ЗаказНаряд.Дата,
		|	ЕСТЬNULL(ЗаказНаряд.Автомобиль.Модель.Наименование, """"),
		|	ВЫБОР
		|		КОГДА ЗаказНаряд.Контрагент.ФормаСобственности = ЗНАЧЕНИЕ(Перечисление.ФормыСобственности.ЧастноеЛицо)
		|			ТОГДА 0
		|		ИНАЧЕ 1
		|	КОНЕЦ,
		|	ЕСТЬNULL(ЗаказНаряд.Автомобиль.ВариантКомплектации.Наименование, """"),
		|	ЕСТЬNULL(ГОД(ЗаказНаряд.Автомобиль.ГодВыпуска), 0),
		|	ЕСТЬNULL(ЗаказНаряд.Автомобиль.ВариантКомплектации.ТипДвигателя.ОбъемДвигателя, 0),
		|	ЕСТЬNULL(ЗаказНаряд.Автомобиль.Цвет.Наименование, """"),
		|	ЕСТЬNULL(ЗаказНаряд.Автомобиль.ТипКПП.Наименование, """"),
		|	ЗаказНаряд.СуммаДокумента,
		|	СписокВидовРемонта.type,
		|	СписокВидовРемонта.isplan,
		|	ЗаказНаряд.Ссылка,
		|	ВЫРАЗИТЬ(ЗаказНаряд.Рекомендации КАК СТРОКА(500))";
	
	Запрос.УстановитьПараметр("КонПериода", КонецДня(КонПериода));
	Запрос.УстановитьПараметр("НачПериода", НачПериода);    
	Запрос.УстановитьПараметр("et", ""+НомерВыгрузки);
	Запрос.УстановитьПараметр("Закрыт", Справочники.ВидыСостоянийЗаказНарядов.Закрыт);
	
	РезультатЗапроса = Запрос.Выполнить();
	ТаблицаДанных = РезультатЗапроса.Выгрузить();
	
	ДобавитьКолонкуСУслугами(ТаблицаДанных);
	
	ВыгрузитьФайл(ТаблицаДанных, ""+НомерВыгрузки,,СписокКолонокПропуска);
	
КонецПроцедуры

Процедура СформироватьФайлПоПродажам() Экспорт
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	РабочийЛистКредитногоОтдела.ДокументОснование КАК ДокументОснование
		|ПОМЕСТИТЬ КредитныеТачки
		|ИЗ
		|	Документ.РабочийЛистКредитногоОтдела КАК РабочийЛистКредитногоОтдела
		|ГДЕ
		|	РабочийЛистКредитногоОтдела.Проведен
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Автомобили.Автомобиль КАК Автомобиль,
		|	ВЫРАЗИТЬ(Автомобили.Значение КАК ЧИСЛО) КАК Пробег,
		|	Автомобили.Период КАК Период
		|ПОМЕСТИТЬ Пробег
		|ИЗ
		|	РегистрСведений.Автомобили КАК Автомобили
		|ГДЕ
		|	Автомобили.ВидЗначения = ЗНАЧЕНИЕ(Перечисление.ДополнительнаяИнформацияАвтомобилей.Пробег)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ПродажиАвтомобилей.ДокументПродажи.Номер КАК id,
		|	ГОД(ПродажиАвтомобилей.ДокументПродажи.Дата) КАК id_год,
		|	1 КАК et,
		|	ПродажиАвтомобилей.Автомобиль.VIN КАК v,
		|	ПродажиАвтомобилей.Период КАК dt,
		|	""Краснодарский край"" КАК er,
		|	""Краснодар"" КАК ec,
		|	ЕСТЬNULL(СпПробег.Пробег, 0) КАК m,
		|	ПродажиАвтомобилей.Автомобиль.Модель.Наименование КАК cmodel,
		|	ЕСТЬNULL(ПродажиАвтомобилей.Автомобиль.ВариантКомплектации.Наименование, """") КАК cdetails,
		|	ЕСТЬNULL(ГОД(ПродажиАвтомобилей.Автомобиль.ГодВыпуска), 0) КАК y,
		|	ЕСТЬNULL(ПродажиАвтомобилей.Автомобиль.Цвет.Наименование, """") КАК ccolor,
		|	ЕСТЬNULL(ПродажиАвтомобилей.Автомобиль.ТипКПП.Наименование, """") КАК ctrans,
		|	ПродажиАвтомобилей.СуммаУпр КАК amnt,
		|	ВЫБОР
		|		КОГДА ПродажиАвтомобилей.ДокументПродажи В
		|				(ВЫБРАТЬ
		|					КредитныеТачки.ДокументОснование КАК ДокументОснование
		|				ИЗ
		|					КредитныеТачки КАК КредитныеТачки)
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК iscrdt,
		|	ВЫБОР
		|		КОГДА ПродажиАвтомобилей.СкладКомпании.тт_СкладНовыхАвтомобилей
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК isn
		|ПОМЕСТИТЬ ПредварительныйИтог
		|ИЗ
		|	РегистрНакопления.ПродажиАвтомобилей КАК ПродажиАвтомобилей
		|		ЛЕВОЕ СОЕДИНЕНИЕ Пробег КАК СпПробег
		|		ПО ПродажиАвтомобилей.Автомобиль = СпПробег.Автомобиль
		|			И ПродажиАвтомобилей.Период <= СпПробег.Период
		|ГДЕ
		|	ПродажиАвтомобилей.Регистратор ССЫЛКА Документ.РеализацияАвтомобилей
		|	И ПродажиАвтомобилей.Период МЕЖДУ &НачПериода И &КонПериода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ПредварительныйИтог.id КАК id,
		|	ПредварительныйИтог.id_год КАК id_год,
		|	ПредварительныйИтог.et КАК et,
		|	ПредварительныйИтог.v КАК v,
		|	ПредварительныйИтог.dt КАК dt,
		|	ПредварительныйИтог.er КАК er,
		|	ПредварительныйИтог.ec КАК ec,
		|	МАКСИМУМ(ПредварительныйИтог.m) КАК m,
		|	ПредварительныйИтог.cmodel КАК cmodel,
		|	ПредварительныйИтог.cdetails КАК cdetails,
		|	ПредварительныйИтог.y КАК y,
		|	ПредварительныйИтог.ccolor КАК ccolor,
		|	ПредварительныйИтог.ctrans КАК ctrans,
		|	ПредварительныйИтог.amnt КАК amnt,
		|	ПредварительныйИтог.iscrdt КАК iscrdt,
		|	ПредварительныйИтог.isn КАК isn
		|ИЗ
		|	ПредварительныйИтог КАК ПредварительныйИтог
		|
		|СГРУППИРОВАТЬ ПО
		|	ПредварительныйИтог.v,
		|	ПредварительныйИтог.cmodel,
		|	ПредварительныйИтог.id,
		|	ПредварительныйИтог.dt,
		|	ПредварительныйИтог.ccolor,
		|	ПредварительныйИтог.ctrans,
		|	ПредварительныйИтог.er,
		|	ПредварительныйИтог.cdetails,
		|	ПредварительныйИтог.ec,
		|	ПредварительныйИтог.id_год,
		|	ПредварительныйИтог.et,
		|	ПредварительныйИтог.y,
		|	ПредварительныйИтог.amnt,
		|	ПредварительныйИтог.iscrdt,
		|	ПредварительныйИтог.isn";
	
	Запрос.УстановитьПараметр("КонПериода", КонецДня(КонПериода));
	Запрос.УстановитьПараметр("НачПериода", НачПериода);
	
	РезультатЗапроса = Запрос.Выполнить();
	ТаблицаДанных = РезультатЗапроса.Выгрузить();
	
	ВыгрузитьФайл(ТаблицаДанных, "1");
	
КонецПроцедуры

Процедура ДобавитьКолонкуСУслугами(ТаблицаДанных)
	
	СписокЗН = новый СписокЗначений;
	СписокЗН.Добавить(ТаблицаДанных.ВыгрузитьКолонку("Ссылка"));
	ТаблицаДанных.Колонки.Добавить("Det");
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ЗаказНарядРаботы.Работа.Наименование КАК РаботаНаименование,
		|	ЗаказНарядРаботы.Ссылка КАК Ссылка
		|ИЗ
		|	Документ.ЗаказНаряд.Работы КАК ЗаказНарядРаботы
		|ГДЕ
		|	ЗаказНарядРаботы.Ссылка В(&Ссылка)
		|ИТОГИ ПО
		|	Ссылка";
	
	Запрос.УстановитьПараметр("Ссылка", СписокЗН);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаСсылка = РезультатЗапроса.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	Пока ВыборкаСсылка.Следующий() Цикл
		
		Нстр = ТаблицаДанных.НайтиСтроки(Новый Структура("Ссылка",ВыборкаСсылка.Ссылка))[0];
		ВыборкаДетальныеЗаписи = ВыборкаСсылка.Выбрать();
	
		Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
			
			НСтр.Det = ""+НСтр.Det + ?(ПустаяСтрока(НСтр.Det),"","; ")+ ВыборкаДетальныеЗаписи.РаботаНаименование;
			
		КонецЦикла;
		
	КонецЦикла;
	
КонецПроцедуры

&НаКлиенте
Функция ПодключитьсяКFTPСерверу()
 
    Соединение = Новый FTPСоединение(
        "storage.yandexcloud.net", // адрес ftp сервера
        443, // порт сервера
        "volvo-kuban", // имя пользователя
        "QVrFWeHUF53D", // пароль пользователя
        Неопределено, // прокси не используется
        Истина, // пассивный режим работы
        0, // таймаут (0 - без ограничений)
        Неопределено // незащищенное соединение
    );
 
    // Для случаев, когда у ftp сервера нет возможности
    // обращаться к нам (мы находимся за межсетевым экраном)
    // следует использовать пассивный режим работы.
 
    Возврат Соединение;
 
КонецФункции

Процедура ВыгрузитьФайл(ТаблицаДанных, НомерВыгрузки, ИмяКолонкиПослеЛокал = "ec", СписокКолонокПропуска = Неопределено);
	
	Если СписокКолонокПропуска = Неопределено Тогда
		
		СписокКолонокПропуска = новый СписокЗначений;
		
	КонецЕсли;
	
	СписокКолонокПропуска.Добавить("id_год");
	
	СтруктураД = Новый Структура;
	СтруктураД.Вставить("id","fkdd");
	СтруктураД.Вставить("name","Оптима Кубань");
	
	ЗаписьJSON = Новый ЗаписьJSON;
	ИмяФайла = ""+ПрифексФайла+"_"+НомерВыгрузки+"_"+Формат(ТекущаяДата(),"ДФ=yyyyMMdd-HHmmss")+".json";
	ПутьКФайлу = ""+КаталогФайла+ИмяФайла;
	ЗаписьJSON.ОткрытьФайл(ПутьКФайлу);
	Мас = Новый Массив;
	Мас.Добавить("-");
	Мас2 = Новый Массив;
	Мас2.Добавить(Новый Структура("label,rating","-",1));
	condition = Новый Структура("stars,issues",Мас2,Мас);
	
	
	
	Damages = Новый Массив;
	Damages.Добавить(Новый Структура("part,type","Не указано","-"));
	
	СтруктураДанныхВыгрузки = Новый Массив;
	
	Для каждого ТекСтр из ТаблицаДанных Цикл
		
		СтруктураДанных = Новый Структура;
		
		Для каждого ТекКолонка из ТаблицаДанных.Колонки Цикл
			
			Если не СписокКолонокПропуска.НайтиПоЗначению(ТекКолонка.Имя) = Неопределено Тогда
				
				Продолжить;
				
			КонецЕсли;
			
			Если ТекКолонка.Имя = ИмяКолонкиПослеЛокал Тогда
				
				СтруктураДанных.Вставить("location",СтруктураД);
				
			КонецЕсли;
			
			Если ТекКолонка.Имя = "Damages" Тогда
				
				СтруктураДанных.Вставить("condition",condition);
				СтруктураДанных.Вставить("Damages",Damages);//Новый Структура("part,type","Не указано","-"));//ТекСтр[ТекКолонка.Имя]));
				
				Продолжить;
				
			КонецЕсли;
			
			Если ТекКолонка.Имя = "id" Тогда
			
				Значение = ""+ТекСтр["id_год"]+"_"+ТекСтр[ТекКолонка.Имя];
				
			Иначе
				
				Значение = ТекСтр[ТекКолонка.Имя];
				
			КонецЕсли;
			
			Если ТипЗнч(Значение) = Тип("Дата") Тогда
				
				СтруктураДанных.Вставить(ТекКолонка.Имя,Формат(Значение,"ДФ=yyyy-MM-dd"));
				
			Иначе
				
				СтруктураДанных.Вставить(ТекКолонка.Имя,Значение);
				
			КонецЕсли;
			
			
			
		КонецЦикла;
		
		СтруктураДанныхВыгрузки.Добавить(СтруктураДанных);
		
	КонецЦикла;
	
	ЗаписатьJSON(ЗаписьJSON, СтруктураДанныхВыгрузки);
	ЗаписьJSON.Закрыть();
	
	Если НаFTP Тогда
		
		//Логин = "volvo-kuban";
		//Порт = "522";
		//Сервер = "roadstore.avito.ru"; 
		//Пароль = "QVrFWeHUF53D";
		//
		//
		//ТекстСценария = "option batch abort
		//        |option confirm on
		//        |open sftp://" + Логин + ":" + Пароль + "@" + Сервер + ":" + Порт + "
		//		|put "+ПутьКФайлу+" /pub/"+ИмяФайла+"
		//		|exit";

		//ИмяФайлаСценария = "c:\temp\выгрузка.txt";
		//ФайлСценария = Новый ТекстовыйДокумент;
		//ФайлСценария.УстановитьТекст(ТекстСценария);
		//ФайлСценария.Записать(ИмяФайлаСценария);

		//ПутьWinSCP = "C:\WinSCP\WinSCP.exe";
		//Команда = """" + ПутьWinSCP + """ /console /script=""" + ИмяФайлаСценария + """";
		//ЗапуститьПриложение(Команда,,Истина);
		
		
		
		//ТекстСценария = "option batch abort
		//|option confirm on
		//|open sftp://" + Логин + ":" + Пароль + "@" + Сервер + ":" + Порт + "
		//|put "+ПутьКФайлу+" /pub/"+ИмяФайла+"
		//|exit";

		//ИмяФайлаСценария = ПолучитьИмяВременногоФайла(".txt");
		//ФайлСценария = Новый ТекстовыйДокумент;
		//ФайлСценария.УстановитьТекст(ТекстСценария);
		//ФайлСценария.Записать(ИмяФайлаСценария);

		//ПутьWinSCP = "C:\WinSCP\WinSCP.exe";
		//Команда = """" + ПутьWinSCP + """ /console /script=""" + ИмяФайлаСценария + """";
		//ЗапуститьПриложение(Команда,,Истина);
		
		//Соединение = ПодключитьсяКFTPСерверу();
		//
		//Соединение.УстановитьТекущийКаталог("/");
		//
		//Соединение.Записать(
		//ПутьКФайлу, // что записываем
		//"/"+ИмяФайла // куда записываем
		//);
		//
		//Сообщить("Передали файл по FTP.");
		
	КонецЕсли;
	
	Если НаЭлПочту Тогда
		
		МассивФайлов = новый Массив;
		СтруктураФайла = Новый Структура("Путь,Имя",ПутьКФайлу,ИмяФайла);
		МассивФайлов.Добавить(СтруктураФайла);
		
		ОтправитьФайлыПоЭлектроннойПочте(АдресЭлектроннойПочты, УчетнаяЗаписьДляОтправки, МассивФайлов);
	КонецЕсли;
	
КонецПроцедуры

//БИЗТЕХ КОВАЛЬ ОТПРАВКА ПО ЭЛПОЧТЕ 17.10.2025 ++

Процедура ОтправитьФайлыПоЭлектроннойПочте(АдресПолучателя, УчетнаяЗапись, МассивФайлов) Экспорт
	
	// Создаем письмо
	Письмо = Новый ИнтернетПочтовоеСообщение;
	Письмо.Тема = "ОБМЕН ДАННЫМИ auto.ru";
	
	// Добавляем получателя
	Получатель = Письмо.Получатели.Добавить(АдресПолучателя);
	Получатель.ОтображаемоеИмя = "";

	// Заполняем данные отправителя
	Письмо.ИмяОтправителя = УчетнаяЗапись.Наименование;
	Письмо.Отправитель.ОтображаемоеИмя = УчетнаяЗапись.Наименование;
	Письмо.Отправитель.Адрес = УчетнаяЗапись.АдресЭлектроннойПочты;
	
	// Добавляем вложения
	Для Каждого Файл Из МассивФайлов Цикл
		ПутьФайла = Файл.Путь;
		ИмяФайла = Файл.Имя;
		Письмо.Вложения.Добавить(ПутьФайла, ИмяФайла);
	КонецЦикла;

	// Тело письма
	ТекстПисьма = "Вложен файл обмена данными с auto.ru";
	Текст = Письмо.Тексты.Добавить(ТекстПисьма);
	Текст.ТипТекста = ТипТекстаПочтовогоСообщения.ПростойТекст;
	
	// обработка текста письма (для картинок и т.п.)
	ОбрабатыватьТекстСообщения = ОбработкаТекстаИнтернетПочтовогоСообщения.Обрабатывать;
	// Не работает - устаревший функционал
	Письмо.УведомитьОДоставке = Ложь;
	// Получаем профиль почтового ящика
	РежимыОбмена = Новый Структура("Получить, Отправить", Ложь, Истина);
	Профиль = эпПолучитьПочтовыйПрофиль(УчетнаяЗапись, РежимыОбмена);
	// Создаем соединение и отправляем письмо
	Соединение = Новый ИнтернетПочта;
	Соединение.Подключиться(Профиль);
	
	Соединение.Послать(Письмо, ОбрабатыватьТекстСообщения);
	
	Сообщить("Письмо отправлено. " + Письмо.ИдентификаторСообщения);
	
КонецПроцедуры
//БИЗТЕХ КОВАЛЬ ОТПРАВКА ПО ЭЛПОЧТЕ 17.10.2025 --