
&НаКлиенте
Процедура ЗагрузитьСхему(Команда)
	НачатьПомещениеФайла(Новый ОписаниеОповещения("ЗагрузитьСхемуЗавершение", ЭтаФорма),,, Истина, УникальныйИдентификатор);
КонецПроцедуры

&НаКлиенте
Процедура ЗагрузитьСхемуЗавершение(Результат, Адрес, ВыбранноеИмяФайла, ДополнительныеПараметры) Экспорт
	Если Результат Тогда
		ЗаполнитьНаСервере(АдресИзображения, Адрес, ВыбранноеИмяФайла);
		Модифицированность = Истина;
	КонецЕсли; 
КонецПроцедуры

&НаСервереБезКонтекста
Процедура ЗаполнитьНаСервере(АдресИзображения, Адрес, ВыбранноеИмяФайла)
	Если ЭтоАдресВременногоХранилища(АдресИзображения) Тогда
		УдалитьИзВременногоХранилища(АдресИзображения);	
	КонецЕсли; 

	АдресИзображения = Адрес;
КонецПроцедуры 

&НаСервере
Процедура ПриЧтенииНаСервере(ТекущийОбъект)
	АдресИзображения = ПолучитьНавигационнуюСсылкуФайла();
КонецПроцедуры

&НаСервере
Функция ПолучитьНавигационнуюСсылкуФайла()
	Возврат ПолучитьНавигационнуюСсылку(Объект.Ссылка, "Схема");
КонецФункции

&НаСервере
Процедура ПередЗаписьюНаСервере(Отказ, ТекущийОбъект, ПараметрыЗаписи)
	Если Модифицированность И ЭтоАдресВременногоХранилища(АдресИзображения) Тогда
		ТекущийОбъект.ДополнительныеСвойства.Вставить("АдресФайла", АдресИзображения);
	КонецЕсли; 
КонецПроцедуры
